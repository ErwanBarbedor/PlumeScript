--[[This file is part of Plume

PlumeðŸª¶ is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, version 3 of the License.

PlumeðŸª¶ is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License along with PlumeðŸª¶.
If not, see <https://www.gnu.org/licenses/>.
]]

-- Generated by make-engine-opt.lua
-- It is an inlined and optimized version of engine.lua
return function (plume)
    function plume._run (chunk, arguments)
        require ("table.new")
        local runtime = chunk
        local bytecode = chunk.bytecode
        local constants = chunk.constants
        local static = chunk.static
        local ip = 0
        local tic = 0
        local mainStack = table.new (2 ^ 14, 0)
        local mainStackFrames = table.new (2 ^ 8, 0)
        local mainStackPointer = 0
        local mainStackFramesPointer = 0
        local variableStack = table.new (2 ^ 10, 0)
        local variableStackFrames = table.new (2 ^ 8, 0)
        local variableStackPointer = 0
        local variableStackFramesPointer = 0
        local fileStack = table.new (2 ^ 8, 0)
        fileStack[1] = 1
        local fileStackPointer = 1
        local macroStack = table.new (2 ^ 8, 0)
        local macroStackPointer = 0
        local injectionStack = table.new (64, 0)
        local injectionStackPointer = 0
        local tagStack = table.new (2 ^ 14, 0)
        local jump = 0
        local empty = plume.obj.empty
        local flag = {}
        local ITER_TABLE = 0
        local ITER_SEQ = 1
        local ITER_ITEMS = 2
        local ITER_ENUMS = 3
        local bit = require ("bit")
        local OP_BITS = 7
        local ARG1_BITS = 5
        local ARG2_BITS = 20
        local ARG1_SHIFT = ARG2_BITS
        local OP_SHIFT = ARG1_BITS + ARG2_BITS
        local MASK_OP = bit.lshift (1, OP_BITS) - 1
        local MASK_ARG1 = bit.lshift (1, ARG1_BITS) - 1
        local MASK_ARG2 = bit.lshift (1, ARG2_BITS) - 1
        local band = bit.band
        local rshift = bit.rshift
        local op, arg1, arg2, vmerr, vmserr
        ::DISPATCH::
            if vmerr then
                return false, vmerr, ip, runtime
            end
            if vmserr then
                return false, unpack (vmserr)
            end
            local _ret1, _ret2, _ret3
            local op, arg1, arg2
            local _ret11
            do
                local _ret12
                _ret12 = macroStackPointer
                local _ret13
                _ret13 = injectionStack[injectionStackPointer]
                print (_ret13, _ret12)
                local _ret14
                _ret14 = injectionStack[injectionStackPointer]
                local _ret15
                _ret15 = macroStackPointer
                _ret11 = injectionStackPointer > 0 and _ret14 == _ret15
                goto _inline_end9
            end
            ::_inline_end9::
            if _ret11 then
                local _ret4, _ret5, _ret6
                do
                    local _ret7
                    injectionStackPointer = injectionStackPointer - 1
                    _ret7 = injectionStack[injectionStackPointer + 1]
                    local _ret8
                    injectionStackPointer = injectionStackPointer - 1
                    _ret8 = injectionStack[injectionStackPointer + 1]
                    local arg2 = _ret8
                    local _ret9
                    injectionStackPointer = injectionStackPointer - 1
                    _ret9 = injectionStack[injectionStackPointer + 1]
                    local arg1 = _ret9
                    local _ret10
                    injectionStackPointer = injectionStackPointer - 1
                    _ret10 = injectionStack[injectionStackPointer + 1]
                    local op = _ret10
                    _ret4, _ret5, _ret6 = op, arg1, arg2
                    goto _inline_end4
                end
                ::_inline_end4::
                op, arg1, arg2 = _ret4, _ret5, _ret6
            else
                if jump > 0 then
                    ip = jump
                    jump = 0
                else
                    ip = ip + 1
                end
                tic = tic + 1
                local instr = bytecode[ip]
                op = band (rshift (instr, OP_SHIFT)
                , MASK_OP)
                arg1 = band (rshift (instr, ARG1_SHIFT)
                , MASK_ARG1)
                arg2 = band (instr, MASK_ARG2)
            end
            _ret1, _ret2, _ret3 = op, arg1, arg2
            op, arg1, arg2 = _ret1, _ret2, _ret3
            if op < 32 then
                if op < 16 then
                    if op < 8 then
                        if op < 4 then
                            if op < 2 then
                                if op < 1 then
                                else
                                    goto LOAD_CONSTANT
                                end
                            else
                                if op < 3 then
                                    goto LOAD_TRUE
                                else
                                    goto LOAD_FALSE
                                end
                            end
                        else
                            if op < 6 then
                                if op < 5 then
                                    goto LOAD_EMPTY
                                else
                                    goto LOAD_LOCAL
                                end
                            else
                                if op < 7 then
                                    goto LOAD_STATIC
                                else
                                    goto STORE_LOCAL
                                end
                            end
                        end
                    else
                        if op < 12 then
                            if op < 10 then
                                if op < 9 then
                                    goto STORE_STATIC
                                else
                                    goto STORE_VOID
                                end
                            else
                                if op < 11 then
                                    goto TABLE_NEW
                                else
                                    goto TABLE_SET
                                end
                            end
                        else
                            if op < 14 then
                                if op < 13 then
                                    goto TABLE_INDEX
                                else
                                    goto TABLE_REGISTER_SELF
                                end
                            else
                                if op < 15 then
                                    goto TABLE_SET_META
                                else
                                    goto TABLE_SET_ACC
                                end
                            end
                        end
                    end
                else
                    if op < 24 then
                        if op < 20 then
                            if op < 18 then
                                if op < 17 then
                                    goto TABLE_EXPAND
                                else
                                    goto CALL_INDEX_REGISTER_SELF
                                end
                            else
                                if op < 19 then
                                    goto TAG_META_KEY
                                else
                                    goto TAG_KEY
                                end
                            end
                        else
                            if op < 22 then
                                if op < 21 then
                                    goto ENTER_SCOPE
                                else
                                    goto LEAVE_SCOPE
                                end
                            else
                                if op < 23 then
                                    goto BEGIN_ACC
                                else
                                    goto CONCAT_TABLE
                                end
                            end
                        end
                    else
                        if op < 28 then
                            if op < 26 then
                                if op < 25 then
                                    goto CONCAT_TEXT
                                else
                                    goto CONCAT_CALL
                                end
                            else
                                if op < 27 then
                                    goto CHECK_IS_TEXT
                                else
                                    goto JUMP_IF
                                end
                            end
                        else
                            if op < 30 then
                                if op < 29 then
                                    goto JUMP_IF_NOT
                                else
                                    goto JUMP_IF_NOT_EMPTY
                                end
                            else
                                if op < 31 then
                                    goto JUMP
                                else
                                    goto JUMP_IF_PEEK
                                end
                            end
                        end
                    end
                end
            else
                if op < 48 then
                    if op < 40 then
                        if op < 36 then
                            if op < 34 then
                                if op < 33 then
                                    goto JUMP_IF_NOT_PEEK
                                else
                                    goto GET_ITER
                                end
                            else
                                if op < 35 then
                                    goto FOR_ITER
                                else
                                    goto OP_ADD
                                end
                            end
                        else
                            if op < 38 then
                                if op < 37 then
                                    goto OP_MUL
                                else
                                    goto OP_SUB
                                end
                            else
                                if op < 39 then
                                    goto OP_DIV
                                else
                                    goto OP_NEG
                                end
                            end
                        end
                    else
                        if op < 44 then
                            if op < 42 then
                                if op < 41 then
                                    goto OP_MOD
                                else
                                    goto OP_POW
                                end
                            else
                                if op < 43 then
                                    goto OP_LT
                                else
                                    goto OP_EQ
                                end
                            end
                        else
                            if op < 46 then
                                if op < 45 then
                                    goto OP_AND
                                else
                                    goto OP_NOT
                                end
                            else
                                if op < 47 then
                                    goto OP_OR
                                else
                                    goto DUPLICATE
                                end
                            end
                        end
                    end
                else
                    if op < 56 then
                        if op < 52 then
                            if op < 50 then
                                if op < 49 then
                                    goto SWITCH
                                else
                                    goto RETURN
                                end
                            else
                                if op < 51 then
                                    goto RETURN_FILE
                                else
                                    goto END
                                end
                            end
                        else
                            if op < 54 then
                                if op < 53 then
                                    goto STD_LEN
                                else
                                    goto STD_TYPE
                                end
                            else
                                if op < 55 then
                                    goto STD_SEQ
                                else
                                    goto STD_ITEMS
                                end
                            end
                        end
                    else
                        if op < 60 then
                            if op < 58 then
                                if op < 57 then
                                    goto STD_ENUMERATE
                                end
                            end
                        end
                    end
                end
            end
            ::LOAD_CONSTANT::
                mainStackPointer = mainStackPointer + 1
                mainStack[mainStackPointer] = constants[arg2]
                goto DISPATCH
            ::LOAD_TRUE::
                mainStackPointer = mainStackPointer + 1
                mainStack[mainStackPointer] = true
                goto DISPATCH
            ::LOAD_FALSE::
                mainStackPointer = mainStackPointer + 1
                mainStack[mainStackPointer] = false
                goto DISPATCH
            ::LOAD_EMPTY::
                mainStackPointer = mainStackPointer + 1
                mainStack[mainStackPointer] = empty
                goto DISPATCH
            ::LOAD_LOCAL::
                do
                    local _ret16
                    do
                        local _ret17
                        _ret17 = variableStackFrames[variableStackFramesPointer + (-arg1 or 0)]
                        local _ret18
                        _ret18 = variableStack[_ret17 + (arg2 - 1 or 0) or variableStackPointer]
                        _ret16 = _ret18
                        goto _inline_end24
                    end
                    ::_inline_end24::
                    mainStackPointer = mainStackPointer + 1
                    mainStack[mainStackPointer] = _ret16
                end
                goto DISPATCH
            ::LOAD_STATIC::
                do
                    local _ret19
                    _ret19 = fileStack[fileStackPointer]
                    mainStackPointer = mainStackPointer + 1
                    mainStack[mainStackPointer] = static[_ret19][arg2]
                end
                goto DISPATCH
            ::STORE_LOCAL::
                do
                    local _ret20
                    mainStackPointer = mainStackPointer - 1
                    _ret20 = mainStack[mainStackPointer + 1]
                    do
                        local _ret21
                        _ret21 = variableStackFrames[variableStackFramesPointer + -arg1 or 0]
                        variableStack[_ret21 + (arg2 - 1 or 0)] = _ret20
                    end
                end
                goto DISPATCH
            ::STORE_STATIC::
                do
                    local _ret22
                    mainStackPointer = mainStackPointer - 1
                    _ret22 = mainStack[mainStackPointer + 1]
                    local _ret23
                    _ret23 = fileStack[fileStackPointer]
                    static[_ret23][arg2] = _ret22
                end
                goto DISPATCH
            ::STORE_VOID::
                do
                    local _ret24
                    mainStackPointer = mainStackPointer - 1
                    _ret24 = mainStack[mainStackPointer + 1]
                end
                goto DISPATCH
            ::TABLE_NEW::
                mainStackPointer = mainStackPointer + 1
                mainStack[mainStackPointer] = table.new (0, arg1)
                goto DISPATCH
            ::TABLE_SET::
                do
                    local t, key, value
                    if arg1 == 1 then
                        local _ret25
                        mainStackPointer = mainStackPointer - 1
                        _ret25 = mainStack[mainStackPointer + 1]
                        value = _ret25
                        local _ret26
                        mainStackPointer = mainStackPointer - 1
                        _ret26 = mainStack[mainStackPointer + 1]
                        key = _ret26
                        local _ret27
                        mainStackPointer = mainStackPointer - 1
                        _ret27 = mainStack[mainStackPointer + 1]
                        t = _ret27
                    else
                        local _ret30
                        mainStackPointer = mainStackPointer - 1
                        _ret30 = mainStack[mainStackPointer + 1]
                        goto _inline_end49
                        ::_inline_end49::
                        t = _ret30
                        local _ret29
                        mainStackPointer = mainStackPointer - 1
                        _ret29 = mainStack[mainStackPointer + 1]
                        goto _inline_end48
                        ::_inline_end48::
                        key = _ret29
                        local _ret28
                        mainStackPointer = mainStackPointer - 1
                        _ret28 = mainStack[mainStackPointer + 1]
                        goto _inline_end47
                        ::_inline_end47::
                        value = _ret28
                    end
                    local meta
                    if not t.table[key] then
                        table.insert (t.keys, key)
                        meta = t.meta.table.setindex
                        if meta then
                            t.table[key] = empty
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = t
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = key
                            mainStackFramesPointer = mainStackFramesPointer + 1
                            mainStackFrames[mainStackFramesPointer] = mainStackPointer + 1
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = key
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = value
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = t
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = "self"
                            do
                                local _ret31
                                _ret31 = mainStackPointer
                                local pos = _ret31
                                tagStack[pos] = "key"
                            end
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = meta
                            do
                                injectionStackPointer = injectionStackPointer + 1
                                injectionStack[injectionStackPointer] = plume.ops.TABLE_SET
                                injectionStackPointer = injectionStackPointer + 1
                                injectionStack[injectionStackPointer] = 1
                                injectionStackPointer = injectionStackPointer + 1
                                injectionStack[injectionStackPointer] = 0
                                local _ret32
                                _ret32 = macroStackPointer
                                injectionStackPointer = injectionStackPointer + 1
                                injectionStack[injectionStackPointer] = _ret32
                            end
                            do
                                injectionStackPointer = injectionStackPointer + 1
                                injectionStack[injectionStackPointer] = plume.ops.CONCAT_CALL
                                injectionStackPointer = injectionStackPointer + 1
                                injectionStack[injectionStackPointer] = 0
                                injectionStackPointer = injectionStackPointer + 1
                                injectionStack[injectionStackPointer] = 0
                                local _ret33
                                _ret33 = macroStackPointer
                                injectionStackPointer = injectionStackPointer + 1
                                injectionStack[injectionStackPointer] = _ret33
                            end
                        end
                    end
                    if not meta then
                        key = tonumber (key) or key
                        t.table[key] = value
                    end
                end
                goto DISPATCH
            ::TABLE_INDEX::
                do
                    local _ret34
                    mainStackPointer = mainStackPointer - 1
                    _ret34 = mainStack[mainStackPointer + 1]
                    local t = _ret34
                    local _ret35
                    mainStackPointer = mainStackPointer - 1
                    _ret35 = mainStack[mainStackPointer + 1]
                    local key = _ret35
                    key = tonumber (key) or key
                    if key == empty then
                        if arg1 == 1 then
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = empty
                        else
                            vmerr = plume.error.cannotUseEmptyAsKey ()
                        end
                    else
                        local _ret38
                        _ret38 = type (t) == "table" and (t == empty or t.type) or (type (t) == "cdata" and t.type) or type (t)
                        goto _inline_end103
                        ::_inline_end103::
                        local tt = _ret38
                        if tt ~= "table" then
                            if arg1 == 1 then
                                mainStackPointer = mainStackPointer + 1
                                mainStack[mainStackPointer] = empty
                            else
                                vmerr = plume.error.cannotIndexValue (tt)
                            end
                        else
                            local value = t.table[key]
                            if value then
                                mainStackPointer = mainStackPointer + 1
                                mainStack[mainStackPointer] = value
                            else
                                if arg1 == 1 then
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = empty
                                elseif t.meta.table.getindex then
                                    local meta = t.meta.table.getindex
                                    mainStackFramesPointer = mainStackFramesPointer + 1
                                    mainStackFrames[mainStackFramesPointer] = mainStackPointer + 1
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = key
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = t
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = "self"
                                    do
                                        local _ret36
                                        _ret36 = mainStackPointer
                                        local pos = _ret36
                                        tagStack[pos] = "key"
                                    end
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = meta
                                    do
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = plume.ops.CONCAT_CALL
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = 0
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = 0
                                        local _ret37
                                        _ret37 = macroStackPointer
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = _ret37
                                    end
                                else
                                    if tonumber (key)
                                     then
                                        vmerr = plume.error.invalidKey (key)
                                    else
                                        vmerr = plume.error.unregisteredKey (key)
                                    end
                                end
                            end
                        end
                    end
                end
                goto DISPATCH
            ::TABLE_REGISTER_SELF::
                TABLE_REGISTER_SELF (vm, arg1, arg2)
                goto DISPATCH
            ::TABLE_SET_META::
                do
                    local _ret39
                    mainStackPointer = mainStackPointer - 1
                    _ret39 = mainStack[mainStackPointer + 1]
                    local t = _ret39
                    local _ret40
                    mainStackPointer = mainStackPointer - 1
                    _ret40 = mainStack[mainStackPointer + 1]
                    local key = _ret40
                    local _ret41
                    mainStackPointer = mainStackPointer - 1
                    _ret41 = mainStack[mainStackPointer + 1]
                    local value = _ret41
                    t.meta.table[key] = value
                end
                goto DISPATCH
            ::TABLE_SET_ACC::
                do
                    local _ret42
                    do
                        local _ret43
                        _ret43 = mainStackFrames[mainStackFramesPointer]
                        local _ret44
                        _ret44 = mainStack[_ret43 or mainStackPointer]
                        _ret42 = _ret44
                        goto _inline_end109
                    end
                    ::_inline_end109::
                    local t = _ret42
                    local _ret45
                    mainStackPointer = mainStackPointer - 1
                    _ret45 = mainStack[mainStackPointer + 1]
                    table.insert (t, _ret45)
                    local _ret46
                    mainStackPointer = mainStackPointer - 1
                    _ret46 = mainStack[mainStackPointer + 1]
                    table.insert (t, _ret46)
                    table.insert (t, arg2 == 1)
                end
                goto DISPATCH
            ::TABLE_EXPAND::
                do
                    local _ret47
                    mainStackPointer = mainStackPointer - 1
                    _ret47 = mainStack[mainStackPointer + 1]
                    local t = _ret47
                    local _ret48
                    _ret48 = type (t) == "table" and (t == empty or t.type) or (type (t) == "cdata" and t.type) or type (t)
                    local tt = _ret48
                    if tt == "table" then
                        for _, item in ipairs (t.table)
                         do
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = item
                        end
                        for _, key in ipairs (t.keys)
                         do
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = t.table[key]
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = key
                            do
                                local _ret49
                                _ret49 = mainStackPointer
                                local pos = _ret49
                                tagStack[pos] = "key"
                            end
                        end
                    else
                        vmerr = plume.error.cannotExpandValue (tt)
                    end
                end
                goto DISPATCH
            ::CALL_INDEX_REGISTER_SELF::
                do
                    local _ret50
                    mainStackPointer = mainStackPointer - 1
                    _ret50 = mainStack[mainStackPointer + 1]
                    local t = _ret50
                    local _ret51
                    mainStackPointer = mainStackPointer - 1
                    _ret51 = mainStack[mainStackPointer + 1]
                    local index = _ret51
                    mainStackPointer = mainStackPointer + 1
                    mainStack[mainStackPointer] = t
                    mainStackPointer = mainStackPointer + 1
                    mainStack[mainStackPointer] = "self"
                    do
                        local _ret52
                        _ret52 = mainStackPointer
                        local pos = _ret52
                        tagStack[pos] = "key"
                    end
                    mainStackPointer = mainStackPointer + 1
                    mainStack[mainStackPointer] = index
                    mainStackPointer = mainStackPointer + 1
                    mainStack[mainStackPointer] = t
                end
                goto DISPATCH
            ::TAG_META_KEY::
                do
                    local _ret53
                    _ret53 = mainStackPointer
                    local pos = _ret53
                    tagStack[pos] = "metakey"
                end
                goto DISPATCH
            ::TAG_KEY::
                do
                    local _ret54
                    _ret54 = mainStackPointer
                    local pos = _ret54
                    tagStack[pos] = "key"
                end
                goto DISPATCH
            ::ENTER_SCOPE::
                do
                    local _ret55
                    _ret55 = variableStackPointer
                    variableStackFramesPointer = variableStackFramesPointer + 1
                    variableStackFrames[variableStackFramesPointer] = _ret55 + 1 - arg1
                    for i = 1, arg2 - arg1 do
                        variableStackPointer = variableStackPointer + 1
                        variableStack[variableStackPointer] = empty
                    end
                end
                goto DISPATCH
            ::LEAVE_SCOPE::
                do
                    local _ret56
                    variableStackFramesPointer = variableStackFramesPointer - 1
                    _ret56 = variableStackFrames[variableStackFramesPointer + 1]
                    variableStackPointer = _ret56 - 1
                end
                goto DISPATCH
            ::BEGIN_ACC::
                mainStackFramesPointer = mainStackFramesPointer + 1
                mainStackFrames[mainStackFramesPointer] = mainStackPointer + 1
                goto DISPATCH
            ::CONCAT_TABLE::
                do
                    local _ret57
                    do
                        local argsOffset = 1
                        local _ret58
                        _ret58 = mainStackFrames[mainStackFramesPointer]
                        local frameOffset = _ret58
                        local bufferOffset = frameOffset
                        local _ret59
                        _ret59 = mainStackPointer
                        local mainStackTop = _ret59
                        local max = mainStackTop - bufferOffset + 1
                        local variadicTable = plume.obj.table (max, max / 2)
                        while bufferOffset <= mainStackTop do
                            local tag = tagStack[bufferOffset + 1]
                            local _ret60
                            _ret60 = mainStack[bufferOffset or mainStackPointer]
                            local value = _ret60
                            if tag == nil then
                                if argsOffset <= 0 then
                                    do
                                        local _ret61
                                        _ret61 = variableStackFrames[variableStackFramesPointer or 0]
                                        variableStack[_ret61 + (argsOffset - 1 or 0)] = value
                                    end
                                else
                                    table.insert (variadicTable.table, value)
                                end
                                argsOffset = argsOffset + 1
                            else
                                bufferOffset = bufferOffset + 1
                                local _ret63
                                _ret63 = mainStack[bufferOffset or mainStackPointer]
                                goto _inline_end158
                                ::_inline_end158::
                                local key = _ret63
                                local argOffset = nil and (nil)[key]
                                if argOffset then
                                    if tag == "key" then
                                        do
                                            local _ret62
                                            _ret62 = variableStackFrames[variableStackFramesPointer or 0]
                                            variableStack[_ret62 + (argOffset - 1 or 0)] = value
                                        end
                                    else
                                        vmerr = plume.error.cannotUseMetaKey
                                    end
                                else
                                    if tag == "key" then
                                        if not variadicTable.table[key] then
                                            table.insert (variadicTable.keys, key)
                                        end
                                        variadicTable.table[key] = value
                                    elseif tag == "metakey" then
                                        variadicTable.meta.table[key] = value
                                    end
                                end
                                tagStack[bufferOffset] = nil
                            end
                            bufferOffset = bufferOffset + 1
                        end
                        _ret57 = variadicTable
                        goto _inline_end147
                    end
                    ::_inline_end147::
                    local resultTable = _ret57
                    do
                        local _ret64
                        mainStackFramesPointer = mainStackFramesPointer - 1
                        _ret64 = mainStackFrames[mainStackFramesPointer + 1]
                        mainStackPointer = _ret64 - 1
                    end
                    mainStackPointer = mainStackPointer + 1
                    mainStack[mainStackPointer] = resultTable
                end
                goto DISPATCH
            ::CONCAT_TEXT::
                do
                    local _ret65
                    _ret65 = mainStackFrames[mainStackFramesPointer]
                    local start = _ret65
                    local _ret66
                    _ret66 = mainStackPointer
                    local stop = _ret66
                    for i = start, stop do
                        local _ret67
                        _ret67 = mainStack[i or mainStackPointer]
                        if _ret67 == empty then
                            mainStack[i] = ""
                        end
                    end
                    local acc_text = table.concat (mainStack, "", start, stop)
                    mainStackPointer = start
                    mainStack[start] = acc_text
                    do
                        local _ret68
                        mainStackFramesPointer = mainStackFramesPointer - 1
                        _ret68 = mainStackFrames[mainStackFramesPointer + 1]
                    end
                end
                goto DISPATCH
            ::CONCAT_CALL::
                do
                    local _ret69
                    mainStackPointer = mainStackPointer - 1
                    _ret69 = mainStack[mainStackPointer + 1]
                    local tocall = _ret69
                    local _ret70
                    _ret70 = type (tocall) == "table" and (tocall == empty or tocall.type) or (type (tocall) == "cdata" and tocall.type) or type (tocall)
                    local t = _ret70
                    local self
                    if t == "table" then
                        if tocall.meta and tocall.meta.table.call then
                            self = tocall
                            tocall = tocall.meta.table.call
                            t = tocall.type
                        end
                    end
                    if t == "macro" then
                        if self then
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = self
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = "self"
                            do
                                local _ret71
                                _ret71 = mainStackPointer
                                local pos = _ret71
                                tagStack[pos] = "key"
                            end
                        end
                        do
                            local allocationCount = tocall.positionalParamCount + tocall.namedParamCount
                            if tocall.variadicOffset then
                                allocationCount = allocationCount + 1
                            end
                            do
                                local _ret72
                                _ret72 = variableStackPointer
                                variableStackFramesPointer = variableStackFramesPointer + 1
                                variableStackFrames[variableStackFramesPointer] = _ret72 + 1
                                for i = 1, allocationCount do
                                    variableStackPointer = variableStackPointer + 1
                                    variableStack[variableStackPointer] = empty
                                end
                            end
                            local _ret73
                            do
                                local argsOffset = 1
                                local _ret74
                                _ret74 = mainStackFrames[mainStackFramesPointer]
                                local frameOffset = _ret74
                                local bufferOffset = frameOffset
                                local _ret75
                                _ret75 = mainStackPointer
                                local mainStackTop = _ret75
                                local max = mainStackTop - bufferOffset + 1
                                local variadicTable = plume.obj.table (max, max / 2)
                                while bufferOffset <= mainStackTop do
                                    local tag = tagStack[bufferOffset + 1]
                                    local _ret76
                                    _ret76 = mainStack[bufferOffset or mainStackPointer]
                                    local value = _ret76
                                    if tag == nil then
                                        if argsOffset <= tocall.positionalParamCount then
                                            do
                                                local _ret77
                                                _ret77 = variableStackFrames[variableStackFramesPointer or 0]
                                                variableStack[_ret77 + (argsOffset - 1 or 0)] = value
                                            end
                                        else
                                            table.insert (variadicTable.table, value)
                                        end
                                        argsOffset = argsOffset + 1
                                    else
                                        bufferOffset = bufferOffset + 1
                                        local _ret79
                                        _ret79 = mainStack[bufferOffset or mainStackPointer]
                                        goto _inline_end196
                                        ::_inline_end196::
                                        local key = _ret79
                                        local argOffset = tocall.namedParamOffset and (tocall.namedParamOffset)[key]
                                        if argOffset then
                                            if tag == "key" then
                                                do
                                                    local _ret78
                                                    _ret78 = variableStackFrames[variableStackFramesPointer or 0]
                                                    variableStack[_ret78 + (argOffset - 1 or 0)] = value
                                                end
                                            else
                                                vmerr = plume.error.cannotUseMetaKey
                                            end
                                        else
                                            if tag == "key" then
                                                if not variadicTable.table[key] then
                                                    table.insert (variadicTable.keys, key)
                                                end
                                                variadicTable.table[key] = value
                                            elseif tag == "metakey" then
                                                variadicTable.meta.table[key] = value
                                            end
                                        end
                                        tagStack[bufferOffset] = nil
                                    end
                                    bufferOffset = bufferOffset + 1
                                end
                                _ret73 = variadicTable
                                goto _inline_end185
                            end
                            ::_inline_end185::
                            local variadicTable = _ret73
                            if tocall.variadicOffset then
                                do
                                    local _ret80
                                    _ret80 = variableStackFrames[variableStackFramesPointer or 0]
                                    variableStack[_ret80 + (tocall.variadicOffset - 1 or 0)] = variadicTable
                                end
                            end
                            do
                                local _ret81
                                mainStackFramesPointer = mainStackFramesPointer - 1
                                _ret81 = mainStackFrames[mainStackFramesPointer + 1]
                                mainStackPointer = _ret81 - 1
                            end
                            macroStackPointer = macroStackPointer + 1
                            macroStack[macroStackPointer] = ip + 1
                            jump = tocall.offset
                        end
                    elseif t == "luaFunction" then
                        do
                            local _ret102
                            do
                                local argsOffset = 1
                                local _ret103
                                _ret103 = mainStackFrames[mainStackFramesPointer]
                                local frameOffset = _ret103
                                local bufferOffset = frameOffset
                                local _ret104
                                _ret104 = mainStackPointer
                                local mainStackTop = _ret104
                                local max = mainStackTop - bufferOffset + 1
                                local variadicTable = plume.obj.table (max, max / 2)
                                while bufferOffset <= mainStackTop do
                                    local tag = tagStack[bufferOffset + 1]
                                    local _ret105
                                    _ret105 = mainStack[bufferOffset or mainStackPointer]
                                    local value = _ret105
                                    if tag == nil then
                                        if argsOffset <= 0 then
                                            do
                                                local _ret106
                                                _ret106 = variableStackFrames[variableStackFramesPointer or 0]
                                                variableStack[_ret106 + (argsOffset - 1 or 0)] = value
                                            end
                                        else
                                            table.insert (variadicTable.table, value)
                                        end
                                        argsOffset = argsOffset + 1
                                    else
                                        bufferOffset = bufferOffset + 1
                                        local _ret108
                                        _ret108 = mainStack[bufferOffset or mainStackPointer]
                                        goto _inline_end268
                                        ::_inline_end268::
                                        local key = _ret108
                                        local argOffset = nil and (nil)[key]
                                        if argOffset then
                                            if tag == "key" then
                                                do
                                                    local _ret107
                                                    _ret107 = variableStackFrames[variableStackFramesPointer or 0]
                                                    variableStack[_ret107 + (argOffset - 1 or 0)] = value
                                                end
                                            else
                                                vmerr = plume.error.cannotUseMetaKey
                                            end
                                        else
                                            if tag == "key" then
                                                if not variadicTable.table[key] then
                                                    table.insert (variadicTable.keys, key)
                                                end
                                                variadicTable.table[key] = value
                                            elseif tag == "metakey" then
                                                variadicTable.meta.table[key] = value
                                            end
                                        end
                                        tagStack[bufferOffset] = nil
                                    end
                                    bufferOffset = bufferOffset + 1
                                end
                                _ret102 = variadicTable
                                goto _inline_end257
                            end
                            ::_inline_end257::
                            local resultTable = _ret102
                            do
                                local _ret109
                                mainStackFramesPointer = mainStackFramesPointer - 1
                                _ret109 = mainStackFrames[mainStackFramesPointer + 1]
                                mainStackPointer = _ret109 - 1
                            end
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = resultTable
                        end
                        table.insert (runtime.callstack, {runtime = runtime, macro = tocall, ip = ip})
                        local _ret110
                        mainStackPointer = mainStackPointer - 1
                        _ret110 = mainStack[mainStackPointer + 1]
                        local success, result = pcall (tocall.callable, _ret110, runtime)
                        if success then
                            table.remove (runtime.callstack)
                            if result == nil then
                                result = empty
                            end
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = result
                        else
                            vmerr = result
                        end
                    elseif t == "luaStdFunction" then
                        do
                            local _ret93
                            do
                                local argsOffset = 1
                                local _ret94
                                _ret94 = mainStackFrames[mainStackFramesPointer]
                                local frameOffset = _ret94
                                local bufferOffset = frameOffset
                                local _ret95
                                _ret95 = mainStackPointer
                                local mainStackTop = _ret95
                                local max = mainStackTop - bufferOffset + 1
                                local variadicTable = plume.obj.table (max, max / 2)
                                while bufferOffset <= mainStackTop do
                                    local tag = tagStack[bufferOffset + 1]
                                    local _ret96
                                    _ret96 = mainStack[bufferOffset or mainStackPointer]
                                    local value = _ret96
                                    if tag == nil then
                                        if argsOffset <= 0 then
                                            do
                                                local _ret97
                                                _ret97 = variableStackFrames[variableStackFramesPointer or 0]
                                                variableStack[_ret97 + (argsOffset - 1 or 0)] = value
                                            end
                                        else
                                            table.insert (variadicTable.table, value)
                                        end
                                        argsOffset = argsOffset + 1
                                    else
                                        bufferOffset = bufferOffset + 1
                                        local _ret99
                                        _ret99 = mainStack[bufferOffset or mainStackPointer]
                                        goto _inline_end245
                                        ::_inline_end245::
                                        local key = _ret99
                                        local argOffset = nil and (nil)[key]
                                        if argOffset then
                                            if tag == "key" then
                                                do
                                                    local _ret98
                                                    _ret98 = variableStackFrames[variableStackFramesPointer or 0]
                                                    variableStack[_ret98 + (argOffset - 1 or 0)] = value
                                                end
                                            else
                                                vmerr = plume.error.cannotUseMetaKey
                                            end
                                        else
                                            if tag == "key" then
                                                if not variadicTable.table[key] then
                                                    table.insert (variadicTable.keys, key)
                                                end
                                                variadicTable.table[key] = value
                                            elseif tag == "metakey" then
                                                variadicTable.meta.table[key] = value
                                            end
                                        end
                                        tagStack[bufferOffset] = nil
                                    end
                                    bufferOffset = bufferOffset + 1
                                end
                                _ret93 = variadicTable
                                goto _inline_end234
                            end
                            ::_inline_end234::
                            local resultTable = _ret93
                            do
                                local _ret100
                                mainStackFramesPointer = mainStackFramesPointer - 1
                                _ret100 = mainStackFrames[mainStackFramesPointer + 1]
                                mainStackPointer = _ret100 - 1
                            end
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = resultTable
                        end
                        do
                            injectionStackPointer = injectionStackPointer + 1
                            injectionStack[injectionStackPointer] = tocall.opcode
                            injectionStackPointer = injectionStackPointer + 1
                            injectionStack[injectionStackPointer] = 0
                            injectionStackPointer = injectionStackPointer + 1
                            injectionStack[injectionStackPointer] = 0
                            local _ret101
                            _ret101 = macroStackPointer
                            injectionStackPointer = injectionStackPointer + 1
                            injectionStack[injectionStackPointer] = _ret101
                        end
                    elseif tocall == plume.std.table then
                        do
                            local _ret85
                            do
                                local argsOffset = 1
                                local _ret86
                                _ret86 = mainStackFrames[mainStackFramesPointer]
                                local frameOffset = _ret86
                                local bufferOffset = frameOffset
                                local _ret87
                                _ret87 = mainStackPointer
                                local mainStackTop = _ret87
                                local max = mainStackTop - bufferOffset + 1
                                local variadicTable = plume.obj.table (max, max / 2)
                                while bufferOffset <= mainStackTop do
                                    local tag = tagStack[bufferOffset + 1]
                                    local _ret88
                                    _ret88 = mainStack[bufferOffset or mainStackPointer]
                                    local value = _ret88
                                    if tag == nil then
                                        if argsOffset <= 0 then
                                            do
                                                local _ret89
                                                _ret89 = variableStackFrames[variableStackFramesPointer or 0]
                                                variableStack[_ret89 + (argsOffset - 1 or 0)] = value
                                            end
                                        else
                                            table.insert (variadicTable.table, value)
                                        end
                                        argsOffset = argsOffset + 1
                                    else
                                        bufferOffset = bufferOffset + 1
                                        local _ret91
                                        _ret91 = mainStack[bufferOffset or mainStackPointer]
                                        goto _inline_end228
                                        ::_inline_end228::
                                        local key = _ret91
                                        local argOffset = nil and (nil)[key]
                                        if argOffset then
                                            if tag == "key" then
                                                do
                                                    local _ret90
                                                    _ret90 = variableStackFrames[variableStackFramesPointer or 0]
                                                    variableStack[_ret90 + (argOffset - 1 or 0)] = value
                                                end
                                            else
                                                vmerr = plume.error.cannotUseMetaKey
                                            end
                                        else
                                            if tag == "key" then
                                                if not variadicTable.table[key] then
                                                    table.insert (variadicTable.keys, key)
                                                end
                                                variadicTable.table[key] = value
                                            elseif tag == "metakey" then
                                                variadicTable.meta.table[key] = value
                                            end
                                        end
                                        tagStack[bufferOffset] = nil
                                    end
                                    bufferOffset = bufferOffset + 1
                                end
                                _ret85 = variadicTable
                                goto _inline_end217
                            end
                            ::_inline_end217::
                            local resultTable = _ret85
                            do
                                local _ret92
                                mainStackFramesPointer = mainStackFramesPointer - 1
                                _ret92 = mainStackFrames[mainStackFramesPointer + 1]
                                mainStackPointer = _ret92 - 1
                            end
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = resultTable
                        end
                    elseif tocall == plume.std.tostring then
                        local _ret82
                        mainStackPointer = mainStackPointer - 1
                        _ret82 = mainStack[mainStackPointer + 1]
                        local value = _ret82
                        do
                            local _ret83
                            mainStackFramesPointer = mainStackFramesPointer - 1
                            _ret83 = mainStackFrames[mainStackFramesPointer + 1]
                            mainStackPointer = _ret83 - 1
                        end
                        mainStackPointer = mainStackPointer + 1
                        mainStack[mainStackPointer] = value
                        do
                            injectionStackPointer = injectionStackPointer + 1
                            injectionStack[injectionStackPointer] = plume.ops.CHECK_IS_TEXT
                            injectionStackPointer = injectionStackPointer + 1
                            injectionStack[injectionStackPointer] = 0
                            injectionStackPointer = injectionStackPointer + 1
                            injectionStack[injectionStackPointer] = 0
                            local _ret84
                            _ret84 = macroStackPointer
                            injectionStackPointer = injectionStackPointer + 1
                            injectionStack[injectionStackPointer] = _ret84
                        end
                    else
                        vmerr = plume.error.cannotCallValue (t)
                    end
                end
                goto DISPATCH
            ::CHECK_IS_TEXT::
                do
                    local _ret111
                    _ret111 = mainStack[mainStackPointer]
                    local value = _ret111
                    local _ret112
                    _ret112 = type (value) == "table" and (value == empty or value.type) or (type (value) == "cdata" and value.type) or type (value)
                    local t = _ret112
                    if t ~= "number" and t ~= "string" and value ~= empty then
                        local meta = t == "table" and value.meta.table.tostring
                        plume.debug.print (value)
                        if meta then
                            local _ret113
                            mainStackPointer = mainStackPointer - 1
                            _ret113 = mainStack[mainStackPointer + 1]
                            mainStackFramesPointer = mainStackFramesPointer + 1
                            mainStackFrames[mainStackFramesPointer] = mainStackPointer + 1
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = t
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = "self"
                            do
                                local _ret114
                                _ret114 = mainStackPointer
                                local pos = _ret114
                                tagStack[pos] = "key"
                            end
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = meta
                            do
                                injectionStackPointer = injectionStackPointer + 1
                                injectionStack[injectionStackPointer] = plume.ops.CONCAT_CALL
                                injectionStackPointer = injectionStackPointer + 1
                                injectionStack[injectionStackPointer] = 0
                                injectionStackPointer = injectionStackPointer + 1
                                injectionStack[injectionStackPointer] = 0
                                local _ret115
                                _ret115 = macroStackPointer
                                injectionStackPointer = injectionStackPointer + 1
                                injectionStack[injectionStackPointer] = _ret115
                            end
                        else
                            vmerr = plume.error.cannotConcatValue (t)
                        end
                    end
                end
                goto DISPATCH
            ::JUMP_IF::
                do
                    local _ret116
                    mainStackPointer = mainStackPointer - 1
                    _ret116 = mainStack[mainStackPointer + 1]
                    local test = _ret116
                    local _ret117
                    if test == empty then
                        _ret117 = false
                        goto _inline_end298
                    end
                    _ret117 = test
                    ::_inline_end298::
                    if _ret117 then
                        jump = arg2
                    end
                end
                goto DISPATCH
            ::JUMP_IF_NOT::
                do
                    local _ret118
                    mainStackPointer = mainStackPointer - 1
                    _ret118 = mainStack[mainStackPointer + 1]
                    local test = _ret118
                    local _ret119
                    if test == empty then
                        _ret119 = false
                        goto _inline_end301
                    end
                    _ret119 = test
                    ::_inline_end301::
                    if not _ret119 then
                        jump = arg2
                    end
                end
                goto DISPATCH
            ::JUMP_IF_NOT_EMPTY::
                do
                    local _ret120
                    mainStackPointer = mainStackPointer - 1
                    _ret120 = mainStack[mainStackPointer + 1]
                    local test = _ret120
                    if test ~= empty then
                        jump = arg2
                    end
                end
                goto DISPATCH
            ::JUMP::
                jump = arg2
                goto DISPATCH
            ::JUMP_IF_PEEK::
                do
                    local _ret121
                    _ret121 = mainStack[mainStackPointer]
                    local test = _ret121
                    local _ret122
                    if test == empty then
                        _ret122 = false
                        goto _inline_end307
                    end
                    _ret122 = test
                    ::_inline_end307::
                    if _ret122 then
                        jump = arg2
                    end
                end
                goto DISPATCH
            ::JUMP_IF_NOT_PEEK::
                do
                    local _ret123
                    _ret123 = mainStack[mainStackPointer]
                    local test = _ret123
                    local _ret124
                    if test == empty then
                        _ret124 = false
                        goto _inline_end310
                    end
                    _ret124 = test
                    ::_inline_end310::
                    if not _ret124 then
                        jump = arg2
                    end
                end
                goto DISPATCH
            ::GET_ITER::
                do
                    local _ret125
                    mainStackPointer = mainStackPointer - 1
                    _ret125 = mainStack[mainStackPointer + 1]
                    local obj = _ret125
                    local _ret126
                    _ret126 = type (obj) == "table" and (obj == empty or obj.type) or (type (obj) == "cdata" and obj.type) or type (obj)
                    local tobj = _ret126
                    local iter, value, flag, macrocall
                    if tobj == "table" then
                        if obj.meta.table.next then
                            iter = obj
                        else
                            iter = obj.meta.table.iter
                        end
                        if iter then
                            if iter.type == "luaFunction" then
                                value = iter.callable ({obj})
                            elseif iter.type == "table" then
                                value = iter
                            elseif iter.type == "macro" then
                                macrocall = true
                            end
                        else
                            value = obj.table
                            flag = ITER_TABLE
                        end
                    elseif tobj == "stdIterator" then
                        value = obj
                        flag = obj.flag
                    else
                        vmerr = plume.error.cannotIterateValue (tobj)
                    end
                    mainStackPointer = mainStackPointer + 1
                    mainStack[mainStackPointer] = flag
                    mainStackPointer = mainStackPointer + 1
                    mainStack[mainStackPointer] = 0
                    if macrocall then
                        mainStackFramesPointer = mainStackFramesPointer + 1
                        mainStackFrames[mainStackFramesPointer] = mainStackPointer + 1
                        mainStackPointer = mainStackPointer + 1
                        mainStack[mainStackPointer] = table.new (0, 0)
                        mainStackPointer = mainStackPointer + 1
                        mainStack[mainStackPointer] = obj
                        TABLE_REGISTER_SELF (vm, 0, 0)
                        local _ret127
                        mainStackPointer = mainStackPointer - 1
                        _ret127 = mainStack[mainStackPointer + 1]
                        mainStackPointer = mainStackPointer + 1
                        mainStack[mainStackPointer] = iter
                        do
                            injectionStackPointer = injectionStackPointer + 1
                            injectionStack[injectionStackPointer] = plume.ops.CONCAT_CALL
                            injectionStackPointer = injectionStackPointer + 1
                            injectionStack[injectionStackPointer] = 0
                            injectionStackPointer = injectionStackPointer + 1
                            injectionStack[injectionStackPointer] = 0
                            local _ret128
                            _ret128 = macroStackPointer
                            injectionStackPointer = injectionStackPointer + 1
                            injectionStack[injectionStackPointer] = _ret128
                        end
                    else
                        mainStackPointer = mainStackPointer + 1
                        mainStack[mainStackPointer] = value
                    end
                end
                goto DISPATCH
            ::FOR_ITER::
                do
                    local _ret129
                    do
                        local _ret130
                        _ret130 = variableStackFrames[variableStackFramesPointer]
                        local _ret131
                        _ret131 = variableStack[_ret130 or variableStackPointer]
                        _ret129 = _ret131
                        goto _inline_end332
                    end
                    ::_inline_end332::
                    local obj = _ret129
                    local _ret132
                    do
                        local _ret133
                        _ret133 = variableStackFrames[variableStackFramesPointer]
                        local _ret134
                        _ret134 = variableStack[_ret133 + 1 or variableStackPointer]
                        _ret132 = _ret134
                        goto _inline_end335
                    end
                    ::_inline_end335::
                    local state = _ret132
                    local _ret135
                    do
                        local _ret136
                        _ret136 = variableStackFrames[variableStackFramesPointer]
                        local _ret137
                        _ret137 = variableStack[_ret136 + 2 or variableStackPointer]
                        _ret135 = _ret137
                        goto _inline_end338
                    end
                    ::_inline_end338::
                    local flag = _ret135
                    local result
                    if flag == ITER_TABLE then
                        state = state + 1
                        if state > #obj then
                            result = empty
                        else
                            result = obj[state]
                        end
                    elseif flag == ITER_SEQ then
                        state = state + obj.step
                        if state > obj.stop then
                            result = empty
                        else
                            result = state
                        end
                    elseif flag == ITER_ENUMS then
                        state = state + 1
                        if state > #obj.ref.table then
                            result = empty
                        else
                            if obj.legacy then
                                result = plume.obj.table (0, 2)
                                result.table.index = state
                                result.table.value = obj.ref.table[state]
                                result.keys = {"index", "value"}
                            else
                                result = plume.obj.table (2, 0)
                                result.table[1] = state
                                result.table[2] = obj.ref.table[state]
                            end
                        end
                    elseif flag == ITER_ITEMS then
                        state = state + 1
                        if state > #obj.ref.keys then
                            result = empty
                        else
                            if obj.legacy then
                                result = plume.obj.table (0, 2)
                                result.table.key = obj.ref.keys[state]
                                result.table.value = obj.ref.table[result.table.key]
                                result.keys = {"key", "value"}
                            else
                                result = plume.obj.table (2, 0)
                                result.table[1] = obj.ref.keys[state]
                                result.table[2] = obj.ref.table[result.table[1]]
                            end
                        end
                    else
                        local iter = obj.meta.table.next
                        if iter.type == "luaFunction" then
                            result = iter.callable ()
                        else
                            local _ret138
                            table.insert (plume.runtime.callstack, {chunk = plume.runtime, macro = iter, ip = ip})
                            if #plume.runtime.callstack <= 500 then
                                local success, callResult, cip, source = plume.run (iter, {obj})
                                if success then
                                    table.remove (plume.runtime.callstack)
                                    _ret138 = callResult
                                    goto _inline_end341
                                else
                                    vmserr = {callResult, cip, (source or iter)}
                                end
                            else
                                vmerr = plume.error.stackOverflow ()
                            end
                            ::_inline_end341::
                            result = _ret138
                        end
                    end
                    do
                        local _ret139
                        _ret139 = variableStackFrames[variableStackFramesPointer or 0]
                        variableStack[_ret139 + 1] = state
                    end
                    if result == empty then
                        jump = arg2
                    else
                        mainStackPointer = mainStackPointer + 1
                        mainStack[mainStackPointer] = result
                    end
                end
                goto DISPATCH
            ::OP_ADD::
                do
                    local _ret140
                    mainStackPointer = mainStackPointer - 1
                    _ret140 = mainStack[mainStackPointer + 1]
                    local right = _ret140
                    local _ret141
                    mainStackPointer = mainStackPointer - 1
                    _ret141 = mainStack[mainStackPointer + 1]
                    local left = _ret141
                    local rightNumber = tonumber (right)
                    local leftNumber = tonumber (left)
                    if rightNumber and leftNumber then
                        local _ret142
                        _ret142 = leftNumber + rightNumber
                        result = _ret142
                        mainStackPointer = mainStackPointer + 1
                        mainStack[mainStackPointer] = result
                    else
                        local rerr, lerr
                        local _ret153, _ret154
                        do
                            local _ret155
                            _ret155 = type (right) == "table" and (right == empty or right.type) or (type (right) == "cdata" and right.type) or type (right)
                            local tx = _ret155
                            if tx == "string" then
                                right = tonumber (right)
                                if not right then
                                    _ret153, _ret154 = right, "Cannot convert the string value to a number."
                                    goto _inline_end382
                                end
                            elseif tx ~= "number" then
                                if tx == "table" and right.meta.table.tonumber then
                                    local meta = right.meta.table.tonumber
                                    local params = {}
                                    local _ret156
                                    table.insert (plume.runtime.callstack, {chunk = plume.runtime, macro = meta, ip = ip})
                                    if #plume.runtime.callstack <= 500 then
                                        local success, callResult, cip, source = plume.run (meta, params)
                                        if success then
                                            table.remove (plume.runtime.callstack)
                                            _ret156 = callResult
                                            goto _inline_end384
                                        else
                                            vmserr = {callResult, cip, (source or meta)}
                                        end
                                    else
                                        vmerr = plume.error.stackOverflow ()
                                    end
                                    ::_inline_end384::
                                    _ret153, _ret154 = _ret156
                                    goto _inline_end382
                                else
                                    _ret153, _ret154 = right, "Cannot do comparison or arithmetic with " .. tostring (tx) .. " value."
                                    goto _inline_end382
                                end
                            end
                            _ret153, _ret154 = right
                            goto _inline_end382
                        end
                        ::_inline_end382::
                        right, rerr = _ret153, _ret154
                        local _ret149, _ret150
                        do
                            local _ret151
                            _ret151 = type (left) == "table" and (left == empty or left.type) or (type (left) == "cdata" and left.type) or type (left)
                            local tx = _ret151
                            if tx == "string" then
                                left = tonumber (left)
                                if not left then
                                    _ret149, _ret150 = left, "Cannot convert the string value to a number."
                                    goto _inline_end377
                                end
                            elseif tx ~= "number" then
                                if tx == "table" and left.meta.table.tonumber then
                                    local meta = left.meta.table.tonumber
                                    local params = {}
                                    local _ret152
                                    table.insert (plume.runtime.callstack, {chunk = plume.runtime, macro = meta, ip = ip})
                                    if #plume.runtime.callstack <= 500 then
                                        local success, callResult, cip, source = plume.run (meta, params)
                                        if success then
                                            table.remove (plume.runtime.callstack)
                                            _ret152 = callResult
                                            goto _inline_end379
                                        else
                                            vmserr = {callResult, cip, (source or meta)}
                                        end
                                    else
                                        vmerr = plume.error.stackOverflow ()
                                    end
                                    ::_inline_end379::
                                    _ret149, _ret150 = _ret152
                                    goto _inline_end377
                                else
                                    _ret149, _ret150 = left, "Cannot do comparison or arithmetic with " .. tostring (tx) .. " value."
                                    goto _inline_end377
                                end
                            end
                            _ret149, _ret150 = left
                            goto _inline_end377
                        end
                        ::_inline_end377::
                        left, lerr = _ret149, _ret150
                        if lerr or rerr then
                            local _ret143
                            do
                                local meta, param1, param2, paramself
                                local _ret144
                                _ret144 = type (left) == "table" and (left == empty or left.type) or (type (left) == "cdata" and left.type) or type (left)
                                local tleft = _ret144
                                local _ret145
                                _ret145 = type (right) == "table" and (right == empty or right.type) or (type (right) == "cdata" and right.type) or type (right)
                                local tright = _ret145
                                if tleft == "table" and left.meta and left.meta.table.addr then
                                    meta = left.meta.table.addr
                                    param1 = right
                                    paramself = left
                                elseif tright == "table" and right.meta and right.meta.table.addl then
                                    meta = right.meta.table.addl
                                    param1 = left
                                    paramself = right
                                elseif tleft == "table" and left.meta and left.meta.table.add then
                                    meta = left.meta.table.add
                                    param1 = left
                                    param2 = right
                                    paramself = left
                                elseif tright == "table" and right.meta and right.meta.table.add then
                                    meta = right.meta.table.add
                                    param1 = left
                                    param2 = right
                                    paramself = right
                                end
                                if meta then
                                    mainStackFramesPointer = mainStackFramesPointer + 1
                                    mainStackFrames[mainStackFramesPointer] = mainStackPointer + 1
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = param1
                                    if param2 then
                                        mainStackPointer = mainStackPointer + 1
                                        mainStack[mainStackPointer] = param2
                                    end
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = paramself
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = "self"
                                    do
                                        local _ret146
                                        _ret146 = mainStackPointer
                                        local pos = _ret146
                                        tagStack[pos] = "key"
                                    end
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = meta
                                    do
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = plume.ops.CONCAT_CALL
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = 0
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = 0
                                        local _ret147
                                        _ret147 = macroStackPointer
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = _ret147
                                    end
                                end
                                _ret143 = meta
                                goto _inline_end355
                            end
                            ::_inline_end355::
                            local meta = _ret143
                            if not meta then
                                vmerr = lerr or rerr
                            end
                        else
                            local _ret148
                            _ret148 = left + right
                            goto _inline_end376
                            ::_inline_end376::
                            result = _ret148
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = result
                        end
                    end
                end
                goto DISPATCH
            ::OP_MUL::
                do
                    local _ret157
                    mainStackPointer = mainStackPointer - 1
                    _ret157 = mainStack[mainStackPointer + 1]
                    local right = _ret157
                    local _ret158
                    mainStackPointer = mainStackPointer - 1
                    _ret158 = mainStack[mainStackPointer + 1]
                    local left = _ret158
                    local rightNumber = tonumber (right)
                    local leftNumber = tonumber (left)
                    if rightNumber and leftNumber then
                        local _ret159
                        _ret159 = leftNumber * rightNumber
                        result = _ret159
                        mainStackPointer = mainStackPointer + 1
                        mainStack[mainStackPointer] = result
                    else
                        local rerr, lerr
                        local _ret170, _ret171
                        do
                            local _ret172
                            _ret172 = type (right) == "table" and (right == empty or right.type) or (type (right) == "cdata" and right.type) or type (right)
                            local tx = _ret172
                            if tx == "string" then
                                right = tonumber (right)
                                if not right then
                                    _ret170, _ret171 = right, "Cannot convert the string value to a number."
                                    goto _inline_end420
                                end
                            elseif tx ~= "number" then
                                if tx == "table" and right.meta.table.tonumber then
                                    local meta = right.meta.table.tonumber
                                    local params = {}
                                    local _ret173
                                    table.insert (plume.runtime.callstack, {chunk = plume.runtime, macro = meta, ip = ip})
                                    if #plume.runtime.callstack <= 500 then
                                        local success, callResult, cip, source = plume.run (meta, params)
                                        if success then
                                            table.remove (plume.runtime.callstack)
                                            _ret173 = callResult
                                            goto _inline_end422
                                        else
                                            vmserr = {callResult, cip, (source or meta)}
                                        end
                                    else
                                        vmerr = plume.error.stackOverflow ()
                                    end
                                    ::_inline_end422::
                                    _ret170, _ret171 = _ret173
                                    goto _inline_end420
                                else
                                    _ret170, _ret171 = right, "Cannot do comparison or arithmetic with " .. tostring (tx) .. " value."
                                    goto _inline_end420
                                end
                            end
                            _ret170, _ret171 = right
                            goto _inline_end420
                        end
                        ::_inline_end420::
                        right, rerr = _ret170, _ret171
                        local _ret166, _ret167
                        do
                            local _ret168
                            _ret168 = type (left) == "table" and (left == empty or left.type) or (type (left) == "cdata" and left.type) or type (left)
                            local tx = _ret168
                            if tx == "string" then
                                left = tonumber (left)
                                if not left then
                                    _ret166, _ret167 = left, "Cannot convert the string value to a number."
                                    goto _inline_end415
                                end
                            elseif tx ~= "number" then
                                if tx == "table" and left.meta.table.tonumber then
                                    local meta = left.meta.table.tonumber
                                    local params = {}
                                    local _ret169
                                    table.insert (plume.runtime.callstack, {chunk = plume.runtime, macro = meta, ip = ip})
                                    if #plume.runtime.callstack <= 500 then
                                        local success, callResult, cip, source = plume.run (meta, params)
                                        if success then
                                            table.remove (plume.runtime.callstack)
                                            _ret169 = callResult
                                            goto _inline_end417
                                        else
                                            vmserr = {callResult, cip, (source or meta)}
                                        end
                                    else
                                        vmerr = plume.error.stackOverflow ()
                                    end
                                    ::_inline_end417::
                                    _ret166, _ret167 = _ret169
                                    goto _inline_end415
                                else
                                    _ret166, _ret167 = left, "Cannot do comparison or arithmetic with " .. tostring (tx) .. " value."
                                    goto _inline_end415
                                end
                            end
                            _ret166, _ret167 = left
                            goto _inline_end415
                        end
                        ::_inline_end415::
                        left, lerr = _ret166, _ret167
                        if lerr or rerr then
                            local _ret160
                            do
                                local meta, param1, param2, paramself
                                local _ret161
                                _ret161 = type (left) == "table" and (left == empty or left.type) or (type (left) == "cdata" and left.type) or type (left)
                                local tleft = _ret161
                                local _ret162
                                _ret162 = type (right) == "table" and (right == empty or right.type) or (type (right) == "cdata" and right.type) or type (right)
                                local tright = _ret162
                                if tleft == "table" and left.meta and left.meta.table.mulr then
                                    meta = left.meta.table.mulr
                                    param1 = right
                                    paramself = left
                                elseif tright == "table" and right.meta and right.meta.table.mull then
                                    meta = right.meta.table.mull
                                    param1 = left
                                    paramself = right
                                elseif tleft == "table" and left.meta and left.meta.table.mul then
                                    meta = left.meta.table.mul
                                    param1 = left
                                    param2 = right
                                    paramself = left
                                elseif tright == "table" and right.meta and right.meta.table.mul then
                                    meta = right.meta.table.mul
                                    param1 = left
                                    param2 = right
                                    paramself = right
                                end
                                if meta then
                                    mainStackFramesPointer = mainStackFramesPointer + 1
                                    mainStackFrames[mainStackFramesPointer] = mainStackPointer + 1
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = param1
                                    if param2 then
                                        mainStackPointer = mainStackPointer + 1
                                        mainStack[mainStackPointer] = param2
                                    end
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = paramself
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = "self"
                                    do
                                        local _ret163
                                        _ret163 = mainStackPointer
                                        local pos = _ret163
                                        tagStack[pos] = "key"
                                    end
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = meta
                                    do
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = plume.ops.CONCAT_CALL
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = 0
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = 0
                                        local _ret164
                                        _ret164 = macroStackPointer
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = _ret164
                                    end
                                end
                                _ret160 = meta
                                goto _inline_end393
                            end
                            ::_inline_end393::
                            local meta = _ret160
                            if not meta then
                                vmerr = lerr or rerr
                            end
                        else
                            local _ret165
                            _ret165 = left * right
                            goto _inline_end414
                            ::_inline_end414::
                            result = _ret165
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = result
                        end
                    end
                end
                goto DISPATCH
            ::OP_SUB::
                do
                    local _ret174
                    mainStackPointer = mainStackPointer - 1
                    _ret174 = mainStack[mainStackPointer + 1]
                    local right = _ret174
                    local _ret175
                    mainStackPointer = mainStackPointer - 1
                    _ret175 = mainStack[mainStackPointer + 1]
                    local left = _ret175
                    local rightNumber = tonumber (right)
                    local leftNumber = tonumber (left)
                    if rightNumber and leftNumber then
                        local _ret176
                        _ret176 = leftNumber - rightNumber
                        result = _ret176
                        mainStackPointer = mainStackPointer + 1
                        mainStack[mainStackPointer] = result
                    else
                        local rerr, lerr
                        local _ret187, _ret188
                        do
                            local _ret189
                            _ret189 = type (right) == "table" and (right == empty or right.type) or (type (right) == "cdata" and right.type) or type (right)
                            local tx = _ret189
                            if tx == "string" then
                                right = tonumber (right)
                                if not right then
                                    _ret187, _ret188 = right, "Cannot convert the string value to a number."
                                    goto _inline_end458
                                end
                            elseif tx ~= "number" then
                                if tx == "table" and right.meta.table.tonumber then
                                    local meta = right.meta.table.tonumber
                                    local params = {}
                                    local _ret190
                                    table.insert (plume.runtime.callstack, {chunk = plume.runtime, macro = meta, ip = ip})
                                    if #plume.runtime.callstack <= 500 then
                                        local success, callResult, cip, source = plume.run (meta, params)
                                        if success then
                                            table.remove (plume.runtime.callstack)
                                            _ret190 = callResult
                                            goto _inline_end460
                                        else
                                            vmserr = {callResult, cip, (source or meta)}
                                        end
                                    else
                                        vmerr = plume.error.stackOverflow ()
                                    end
                                    ::_inline_end460::
                                    _ret187, _ret188 = _ret190
                                    goto _inline_end458
                                else
                                    _ret187, _ret188 = right, "Cannot do comparison or arithmetic with " .. tostring (tx) .. " value."
                                    goto _inline_end458
                                end
                            end
                            _ret187, _ret188 = right
                            goto _inline_end458
                        end
                        ::_inline_end458::
                        right, rerr = _ret187, _ret188
                        local _ret183, _ret184
                        do
                            local _ret185
                            _ret185 = type (left) == "table" and (left == empty or left.type) or (type (left) == "cdata" and left.type) or type (left)
                            local tx = _ret185
                            if tx == "string" then
                                left = tonumber (left)
                                if not left then
                                    _ret183, _ret184 = left, "Cannot convert the string value to a number."
                                    goto _inline_end453
                                end
                            elseif tx ~= "number" then
                                if tx == "table" and left.meta.table.tonumber then
                                    local meta = left.meta.table.tonumber
                                    local params = {}
                                    local _ret186
                                    table.insert (plume.runtime.callstack, {chunk = plume.runtime, macro = meta, ip = ip})
                                    if #plume.runtime.callstack <= 500 then
                                        local success, callResult, cip, source = plume.run (meta, params)
                                        if success then
                                            table.remove (plume.runtime.callstack)
                                            _ret186 = callResult
                                            goto _inline_end455
                                        else
                                            vmserr = {callResult, cip, (source or meta)}
                                        end
                                    else
                                        vmerr = plume.error.stackOverflow ()
                                    end
                                    ::_inline_end455::
                                    _ret183, _ret184 = _ret186
                                    goto _inline_end453
                                else
                                    _ret183, _ret184 = left, "Cannot do comparison or arithmetic with " .. tostring (tx) .. " value."
                                    goto _inline_end453
                                end
                            end
                            _ret183, _ret184 = left
                            goto _inline_end453
                        end
                        ::_inline_end453::
                        left, lerr = _ret183, _ret184
                        if lerr or rerr then
                            local _ret177
                            do
                                local meta, param1, param2, paramself
                                local _ret178
                                _ret178 = type (left) == "table" and (left == empty or left.type) or (type (left) == "cdata" and left.type) or type (left)
                                local tleft = _ret178
                                local _ret179
                                _ret179 = type (right) == "table" and (right == empty or right.type) or (type (right) == "cdata" and right.type) or type (right)
                                local tright = _ret179
                                if tleft == "table" and left.meta and left.meta.table.subr then
                                    meta = left.meta.table.subr
                                    param1 = right
                                    paramself = left
                                elseif tright == "table" and right.meta and right.meta.table.subl then
                                    meta = right.meta.table.subl
                                    param1 = left
                                    paramself = right
                                elseif tleft == "table" and left.meta and left.meta.table.sub then
                                    meta = left.meta.table.sub
                                    param1 = left
                                    param2 = right
                                    paramself = left
                                elseif tright == "table" and right.meta and right.meta.table.sub then
                                    meta = right.meta.table.sub
                                    param1 = left
                                    param2 = right
                                    paramself = right
                                end
                                if meta then
                                    mainStackFramesPointer = mainStackFramesPointer + 1
                                    mainStackFrames[mainStackFramesPointer] = mainStackPointer + 1
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = param1
                                    if param2 then
                                        mainStackPointer = mainStackPointer + 1
                                        mainStack[mainStackPointer] = param2
                                    end
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = paramself
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = "self"
                                    do
                                        local _ret180
                                        _ret180 = mainStackPointer
                                        local pos = _ret180
                                        tagStack[pos] = "key"
                                    end
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = meta
                                    do
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = plume.ops.CONCAT_CALL
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = 0
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = 0
                                        local _ret181
                                        _ret181 = macroStackPointer
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = _ret181
                                    end
                                end
                                _ret177 = meta
                                goto _inline_end431
                            end
                            ::_inline_end431::
                            local meta = _ret177
                            if not meta then
                                vmerr = lerr or rerr
                            end
                        else
                            local _ret182
                            _ret182 = left - right
                            goto _inline_end452
                            ::_inline_end452::
                            result = _ret182
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = result
                        end
                    end
                end
                goto DISPATCH
            ::OP_DIV::
                do
                    local _ret191
                    mainStackPointer = mainStackPointer - 1
                    _ret191 = mainStack[mainStackPointer + 1]
                    local right = _ret191
                    local _ret192
                    mainStackPointer = mainStackPointer - 1
                    _ret192 = mainStack[mainStackPointer + 1]
                    local left = _ret192
                    local rightNumber = tonumber (right)
                    local leftNumber = tonumber (left)
                    if rightNumber and leftNumber then
                        local _ret193
                        _ret193 = leftNumber / rightNumber
                        result = _ret193
                        mainStackPointer = mainStackPointer + 1
                        mainStack[mainStackPointer] = result
                    else
                        local rerr, lerr
                        local _ret204, _ret205
                        do
                            local _ret206
                            _ret206 = type (right) == "table" and (right == empty or right.type) or (type (right) == "cdata" and right.type) or type (right)
                            local tx = _ret206
                            if tx == "string" then
                                right = tonumber (right)
                                if not right then
                                    _ret204, _ret205 = right, "Cannot convert the string value to a number."
                                    goto _inline_end496
                                end
                            elseif tx ~= "number" then
                                if tx == "table" and right.meta.table.tonumber then
                                    local meta = right.meta.table.tonumber
                                    local params = {}
                                    local _ret207
                                    table.insert (plume.runtime.callstack, {chunk = plume.runtime, macro = meta, ip = ip})
                                    if #plume.runtime.callstack <= 500 then
                                        local success, callResult, cip, source = plume.run (meta, params)
                                        if success then
                                            table.remove (plume.runtime.callstack)
                                            _ret207 = callResult
                                            goto _inline_end498
                                        else
                                            vmserr = {callResult, cip, (source or meta)}
                                        end
                                    else
                                        vmerr = plume.error.stackOverflow ()
                                    end
                                    ::_inline_end498::
                                    _ret204, _ret205 = _ret207
                                    goto _inline_end496
                                else
                                    _ret204, _ret205 = right, "Cannot do comparison or arithmetic with " .. tostring (tx) .. " value."
                                    goto _inline_end496
                                end
                            end
                            _ret204, _ret205 = right
                            goto _inline_end496
                        end
                        ::_inline_end496::
                        right, rerr = _ret204, _ret205
                        local _ret200, _ret201
                        do
                            local _ret202
                            _ret202 = type (left) == "table" and (left == empty or left.type) or (type (left) == "cdata" and left.type) or type (left)
                            local tx = _ret202
                            if tx == "string" then
                                left = tonumber (left)
                                if not left then
                                    _ret200, _ret201 = left, "Cannot convert the string value to a number."
                                    goto _inline_end491
                                end
                            elseif tx ~= "number" then
                                if tx == "table" and left.meta.table.tonumber then
                                    local meta = left.meta.table.tonumber
                                    local params = {}
                                    local _ret203
                                    table.insert (plume.runtime.callstack, {chunk = plume.runtime, macro = meta, ip = ip})
                                    if #plume.runtime.callstack <= 500 then
                                        local success, callResult, cip, source = plume.run (meta, params)
                                        if success then
                                            table.remove (plume.runtime.callstack)
                                            _ret203 = callResult
                                            goto _inline_end493
                                        else
                                            vmserr = {callResult, cip, (source or meta)}
                                        end
                                    else
                                        vmerr = plume.error.stackOverflow ()
                                    end
                                    ::_inline_end493::
                                    _ret200, _ret201 = _ret203
                                    goto _inline_end491
                                else
                                    _ret200, _ret201 = left, "Cannot do comparison or arithmetic with " .. tostring (tx) .. " value."
                                    goto _inline_end491
                                end
                            end
                            _ret200, _ret201 = left
                            goto _inline_end491
                        end
                        ::_inline_end491::
                        left, lerr = _ret200, _ret201
                        if lerr or rerr then
                            local _ret194
                            do
                                local meta, param1, param2, paramself
                                local _ret195
                                _ret195 = type (left) == "table" and (left == empty or left.type) or (type (left) == "cdata" and left.type) or type (left)
                                local tleft = _ret195
                                local _ret196
                                _ret196 = type (right) == "table" and (right == empty or right.type) or (type (right) == "cdata" and right.type) or type (right)
                                local tright = _ret196
                                if tleft == "table" and left.meta and left.meta.table.divr then
                                    meta = left.meta.table.divr
                                    param1 = right
                                    paramself = left
                                elseif tright == "table" and right.meta and right.meta.table.divl then
                                    meta = right.meta.table.divl
                                    param1 = left
                                    paramself = right
                                elseif tleft == "table" and left.meta and left.meta.table.div then
                                    meta = left.meta.table.div
                                    param1 = left
                                    param2 = right
                                    paramself = left
                                elseif tright == "table" and right.meta and right.meta.table.div then
                                    meta = right.meta.table.div
                                    param1 = left
                                    param2 = right
                                    paramself = right
                                end
                                if meta then
                                    mainStackFramesPointer = mainStackFramesPointer + 1
                                    mainStackFrames[mainStackFramesPointer] = mainStackPointer + 1
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = param1
                                    if param2 then
                                        mainStackPointer = mainStackPointer + 1
                                        mainStack[mainStackPointer] = param2
                                    end
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = paramself
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = "self"
                                    do
                                        local _ret197
                                        _ret197 = mainStackPointer
                                        local pos = _ret197
                                        tagStack[pos] = "key"
                                    end
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = meta
                                    do
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = plume.ops.CONCAT_CALL
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = 0
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = 0
                                        local _ret198
                                        _ret198 = macroStackPointer
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = _ret198
                                    end
                                end
                                _ret194 = meta
                                goto _inline_end469
                            end
                            ::_inline_end469::
                            local meta = _ret194
                            if not meta then
                                vmerr = lerr or rerr
                            end
                        else
                            local _ret199
                            _ret199 = left / right
                            goto _inline_end490
                            ::_inline_end490::
                            result = _ret199
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = result
                        end
                    end
                end
                goto DISPATCH
            ::OP_NEG::
                do
                    local _ret208
                    mainStackPointer = mainStackPointer - 1
                    _ret208 = mainStack[mainStackPointer + 1]
                    local x = _ret208
                    local err, meta
                    local _ret209, _ret210
                    do
                        local _ret211
                        _ret211 = type (x) == "table" and (x == empty or x.type) or (type (x) == "cdata" and x.type) or type (x)
                        local tx = _ret211
                        if tx == "string" then
                            x = tonumber (x)
                            if not x then
                                _ret209, _ret210 = x, "Cannot convert the string value to a number."
                                goto _inline_end504
                            end
                        elseif tx ~= "number" then
                            if tx == "table" and x.meta.table.tonumber then
                                local meta = x.meta.table.tonumber
                                local params = {}
                                local _ret212
                                table.insert (plume.runtime.callstack, {chunk = plume.runtime, macro = meta, ip = ip})
                                if #plume.runtime.callstack <= 500 then
                                    local success, callResult, cip, source = plume.run (meta, params)
                                    if success then
                                        table.remove (plume.runtime.callstack)
                                        _ret212 = callResult
                                        goto _inline_end506
                                    else
                                        vmserr = {callResult, cip, (source or meta)}
                                    end
                                else
                                    vmerr = plume.error.stackOverflow ()
                                end
                                ::_inline_end506::
                                _ret209, _ret210 = _ret212
                                goto _inline_end504
                            else
                                _ret209, _ret210 = x, "Cannot do comparison or arithmetic with " .. tostring (tx) .. " value."
                                goto _inline_end504
                            end
                        end
                        _ret209, _ret210 = x
                        goto _inline_end504
                    end
                    ::_inline_end504::
                    x, err = _ret209, _ret210
                    if err then
                        local _ret213
                        do
                            local meta
                            local _ret214
                            _ret214 = type (x) == "table" and (x == empty or x.type) or (type (x) == "cdata" and x.type) or type (x)
                            if _ret214 == "table" and x.meta and x.meta.table.minus then
                                meta = x.meta.table.minus
                            end
                            if meta then
                                mainStackFramesPointer = mainStackFramesPointer + 1
                                mainStackFrames[mainStackFramesPointer] = mainStackPointer + 1
                                mainStackPointer = mainStackPointer + 1
                                mainStack[mainStackPointer] = x
                                mainStackPointer = mainStackPointer + 1
                                mainStack[mainStackPointer] = paramself
                                mainStackPointer = mainStackPointer + 1
                                mainStack[mainStackPointer] = "self"
                                do
                                    local _ret215
                                    _ret215 = mainStackPointer
                                    local pos = _ret215
                                    tagStack[pos] = "key"
                                end
                                mainStackPointer = mainStackPointer + 1
                                mainStack[mainStackPointer] = meta
                                do
                                    injectionStackPointer = injectionStackPointer + 1
                                    injectionStack[injectionStackPointer] = plume.ops.CONCAT_CALL
                                    injectionStackPointer = injectionStackPointer + 1
                                    injectionStack[injectionStackPointer] = 0
                                    injectionStackPointer = injectionStackPointer + 1
                                    injectionStack[injectionStackPointer] = 0
                                    local _ret216
                                    _ret216 = macroStackPointer
                                    injectionStackPointer = injectionStackPointer + 1
                                    injectionStack[injectionStackPointer] = _ret216
                                end
                            end
                            _ret213 = meta
                            goto _inline_end509
                        end
                        ::_inline_end509::
                        meta = _ret213
                        if not meta then
                            vmerr = err
                        end
                    else
                        local _ret217
                        _ret217 = -x
                        goto _inline_end527
                        ::_inline_end527::
                        mainStackPointer = mainStackPointer + 1
                        mainStack[mainStackPointer] = _ret217
                    end
                end
                goto DISPATCH
            ::OP_MOD::
                do
                    local _ret218
                    mainStackPointer = mainStackPointer - 1
                    _ret218 = mainStack[mainStackPointer + 1]
                    local right = _ret218
                    local _ret219
                    mainStackPointer = mainStackPointer - 1
                    _ret219 = mainStack[mainStackPointer + 1]
                    local left = _ret219
                    local rightNumber = tonumber (right)
                    local leftNumber = tonumber (left)
                    if rightNumber and leftNumber then
                        local _ret220
                        _ret220 = leftNumber % rightNumber
                        result = _ret220
                        mainStackPointer = mainStackPointer + 1
                        mainStack[mainStackPointer] = result
                    else
                        local rerr, lerr
                        local _ret231, _ret232
                        do
                            local _ret233
                            _ret233 = type (right) == "table" and (right == empty or right.type) or (type (right) == "cdata" and right.type) or type (right)
                            local tx = _ret233
                            if tx == "string" then
                                right = tonumber (right)
                                if not right then
                                    _ret231, _ret232 = right, "Cannot convert the string value to a number."
                                    goto _inline_end562
                                end
                            elseif tx ~= "number" then
                                if tx == "table" and right.meta.table.tonumber then
                                    local meta = right.meta.table.tonumber
                                    local params = {}
                                    local _ret234
                                    table.insert (plume.runtime.callstack, {chunk = plume.runtime, macro = meta, ip = ip})
                                    if #plume.runtime.callstack <= 500 then
                                        local success, callResult, cip, source = plume.run (meta, params)
                                        if success then
                                            table.remove (plume.runtime.callstack)
                                            _ret234 = callResult
                                            goto _inline_end564
                                        else
                                            vmserr = {callResult, cip, (source or meta)}
                                        end
                                    else
                                        vmerr = plume.error.stackOverflow ()
                                    end
                                    ::_inline_end564::
                                    _ret231, _ret232 = _ret234
                                    goto _inline_end562
                                else
                                    _ret231, _ret232 = right, "Cannot do comparison or arithmetic with " .. tostring (tx) .. " value."
                                    goto _inline_end562
                                end
                            end
                            _ret231, _ret232 = right
                            goto _inline_end562
                        end
                        ::_inline_end562::
                        right, rerr = _ret231, _ret232
                        local _ret227, _ret228
                        do
                            local _ret229
                            _ret229 = type (left) == "table" and (left == empty or left.type) or (type (left) == "cdata" and left.type) or type (left)
                            local tx = _ret229
                            if tx == "string" then
                                left = tonumber (left)
                                if not left then
                                    _ret227, _ret228 = left, "Cannot convert the string value to a number."
                                    goto _inline_end557
                                end
                            elseif tx ~= "number" then
                                if tx == "table" and left.meta.table.tonumber then
                                    local meta = left.meta.table.tonumber
                                    local params = {}
                                    local _ret230
                                    table.insert (plume.runtime.callstack, {chunk = plume.runtime, macro = meta, ip = ip})
                                    if #plume.runtime.callstack <= 500 then
                                        local success, callResult, cip, source = plume.run (meta, params)
                                        if success then
                                            table.remove (plume.runtime.callstack)
                                            _ret230 = callResult
                                            goto _inline_end559
                                        else
                                            vmserr = {callResult, cip, (source or meta)}
                                        end
                                    else
                                        vmerr = plume.error.stackOverflow ()
                                    end
                                    ::_inline_end559::
                                    _ret227, _ret228 = _ret230
                                    goto _inline_end557
                                else
                                    _ret227, _ret228 = left, "Cannot do comparison or arithmetic with " .. tostring (tx) .. " value."
                                    goto _inline_end557
                                end
                            end
                            _ret227, _ret228 = left
                            goto _inline_end557
                        end
                        ::_inline_end557::
                        left, lerr = _ret227, _ret228
                        if lerr or rerr then
                            local _ret221
                            do
                                local meta, param1, param2, paramself
                                local _ret222
                                _ret222 = type (left) == "table" and (left == empty or left.type) or (type (left) == "cdata" and left.type) or type (left)
                                local tleft = _ret222
                                local _ret223
                                _ret223 = type (right) == "table" and (right == empty or right.type) or (type (right) == "cdata" and right.type) or type (right)
                                local tright = _ret223
                                if tleft == "table" and left.meta and left.meta.table.modr then
                                    meta = left.meta.table.modr
                                    param1 = right
                                    paramself = left
                                elseif tright == "table" and right.meta and right.meta.table.modl then
                                    meta = right.meta.table.modl
                                    param1 = left
                                    paramself = right
                                elseif tleft == "table" and left.meta and left.meta.table.mod then
                                    meta = left.meta.table.mod
                                    param1 = left
                                    param2 = right
                                    paramself = left
                                elseif tright == "table" and right.meta and right.meta.table.mod then
                                    meta = right.meta.table.mod
                                    param1 = left
                                    param2 = right
                                    paramself = right
                                end
                                if meta then
                                    mainStackFramesPointer = mainStackFramesPointer + 1
                                    mainStackFrames[mainStackFramesPointer] = mainStackPointer + 1
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = param1
                                    if param2 then
                                        mainStackPointer = mainStackPointer + 1
                                        mainStack[mainStackPointer] = param2
                                    end
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = paramself
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = "self"
                                    do
                                        local _ret224
                                        _ret224 = mainStackPointer
                                        local pos = _ret224
                                        tagStack[pos] = "key"
                                    end
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = meta
                                    do
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = plume.ops.CONCAT_CALL
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = 0
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = 0
                                        local _ret225
                                        _ret225 = macroStackPointer
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = _ret225
                                    end
                                end
                                _ret221 = meta
                                goto _inline_end535
                            end
                            ::_inline_end535::
                            local meta = _ret221
                            if not meta then
                                vmerr = lerr or rerr
                            end
                        else
                            local _ret226
                            _ret226 = left % right
                            goto _inline_end556
                            ::_inline_end556::
                            result = _ret226
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = result
                        end
                    end
                end
                goto DISPATCH
            ::OP_POW::
                do
                    local _ret235
                    mainStackPointer = mainStackPointer - 1
                    _ret235 = mainStack[mainStackPointer + 1]
                    local right = _ret235
                    local _ret236
                    mainStackPointer = mainStackPointer - 1
                    _ret236 = mainStack[mainStackPointer + 1]
                    local left = _ret236
                    local rightNumber = tonumber (right)
                    local leftNumber = tonumber (left)
                    if rightNumber and leftNumber then
                        local _ret237
                        _ret237 = leftNumber ^ rightNumber
                        result = _ret237
                        mainStackPointer = mainStackPointer + 1
                        mainStack[mainStackPointer] = result
                    else
                        local rerr, lerr
                        local _ret248, _ret249
                        do
                            local _ret250
                            _ret250 = type (right) == "table" and (right == empty or right.type) or (type (right) == "cdata" and right.type) or type (right)
                            local tx = _ret250
                            if tx == "string" then
                                right = tonumber (right)
                                if not right then
                                    _ret248, _ret249 = right, "Cannot convert the string value to a number."
                                    goto _inline_end600
                                end
                            elseif tx ~= "number" then
                                if tx == "table" and right.meta.table.tonumber then
                                    local meta = right.meta.table.tonumber
                                    local params = {}
                                    local _ret251
                                    table.insert (plume.runtime.callstack, {chunk = plume.runtime, macro = meta, ip = ip})
                                    if #plume.runtime.callstack <= 500 then
                                        local success, callResult, cip, source = plume.run (meta, params)
                                        if success then
                                            table.remove (plume.runtime.callstack)
                                            _ret251 = callResult
                                            goto _inline_end602
                                        else
                                            vmserr = {callResult, cip, (source or meta)}
                                        end
                                    else
                                        vmerr = plume.error.stackOverflow ()
                                    end
                                    ::_inline_end602::
                                    _ret248, _ret249 = _ret251
                                    goto _inline_end600
                                else
                                    _ret248, _ret249 = right, "Cannot do comparison or arithmetic with " .. tostring (tx) .. " value."
                                    goto _inline_end600
                                end
                            end
                            _ret248, _ret249 = right
                            goto _inline_end600
                        end
                        ::_inline_end600::
                        right, rerr = _ret248, _ret249
                        local _ret244, _ret245
                        do
                            local _ret246
                            _ret246 = type (left) == "table" and (left == empty or left.type) or (type (left) == "cdata" and left.type) or type (left)
                            local tx = _ret246
                            if tx == "string" then
                                left = tonumber (left)
                                if not left then
                                    _ret244, _ret245 = left, "Cannot convert the string value to a number."
                                    goto _inline_end595
                                end
                            elseif tx ~= "number" then
                                if tx == "table" and left.meta.table.tonumber then
                                    local meta = left.meta.table.tonumber
                                    local params = {}
                                    local _ret247
                                    table.insert (plume.runtime.callstack, {chunk = plume.runtime, macro = meta, ip = ip})
                                    if #plume.runtime.callstack <= 500 then
                                        local success, callResult, cip, source = plume.run (meta, params)
                                        if success then
                                            table.remove (plume.runtime.callstack)
                                            _ret247 = callResult
                                            goto _inline_end597
                                        else
                                            vmserr = {callResult, cip, (source or meta)}
                                        end
                                    else
                                        vmerr = plume.error.stackOverflow ()
                                    end
                                    ::_inline_end597::
                                    _ret244, _ret245 = _ret247
                                    goto _inline_end595
                                else
                                    _ret244, _ret245 = left, "Cannot do comparison or arithmetic with " .. tostring (tx) .. " value."
                                    goto _inline_end595
                                end
                            end
                            _ret244, _ret245 = left
                            goto _inline_end595
                        end
                        ::_inline_end595::
                        left, lerr = _ret244, _ret245
                        if lerr or rerr then
                            local _ret238
                            do
                                local meta, param1, param2, paramself
                                local _ret239
                                _ret239 = type (left) == "table" and (left == empty or left.type) or (type (left) == "cdata" and left.type) or type (left)
                                local tleft = _ret239
                                local _ret240
                                _ret240 = type (right) == "table" and (right == empty or right.type) or (type (right) == "cdata" and right.type) or type (right)
                                local tright = _ret240
                                if tleft == "table" and left.meta and left.meta.table.powr then
                                    meta = left.meta.table.powr
                                    param1 = right
                                    paramself = left
                                elseif tright == "table" and right.meta and right.meta.table.powl then
                                    meta = right.meta.table.powl
                                    param1 = left
                                    paramself = right
                                elseif tleft == "table" and left.meta and left.meta.table.pow then
                                    meta = left.meta.table.pow
                                    param1 = left
                                    param2 = right
                                    paramself = left
                                elseif tright == "table" and right.meta and right.meta.table.pow then
                                    meta = right.meta.table.pow
                                    param1 = left
                                    param2 = right
                                    paramself = right
                                end
                                if meta then
                                    mainStackFramesPointer = mainStackFramesPointer + 1
                                    mainStackFrames[mainStackFramesPointer] = mainStackPointer + 1
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = param1
                                    if param2 then
                                        mainStackPointer = mainStackPointer + 1
                                        mainStack[mainStackPointer] = param2
                                    end
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = paramself
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = "self"
                                    do
                                        local _ret241
                                        _ret241 = mainStackPointer
                                        local pos = _ret241
                                        tagStack[pos] = "key"
                                    end
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = meta
                                    do
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = plume.ops.CONCAT_CALL
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = 0
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = 0
                                        local _ret242
                                        _ret242 = macroStackPointer
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = _ret242
                                    end
                                end
                                _ret238 = meta
                                goto _inline_end573
                            end
                            ::_inline_end573::
                            local meta = _ret238
                            if not meta then
                                vmerr = lerr or rerr
                            end
                        else
                            local _ret243
                            _ret243 = left ^ right
                            goto _inline_end594
                            ::_inline_end594::
                            result = _ret243
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = result
                        end
                    end
                end
                goto DISPATCH
            ::OP_LT::
                do
                    local _ret252
                    mainStackPointer = mainStackPointer - 1
                    _ret252 = mainStack[mainStackPointer + 1]
                    local right = _ret252
                    local _ret253
                    mainStackPointer = mainStackPointer - 1
                    _ret253 = mainStack[mainStackPointer + 1]
                    local left = _ret253
                    local rightNumber = tonumber (right)
                    local leftNumber = tonumber (left)
                    if rightNumber and leftNumber then
                        local _ret254
                        _ret254 = leftNumber < rightNumber
                        result = _ret254
                        mainStackPointer = mainStackPointer + 1
                        mainStack[mainStackPointer] = result
                    else
                        local rerr, lerr
                        local _ret265, _ret266
                        do
                            local _ret267
                            _ret267 = type (right) == "table" and (right == empty or right.type) or (type (right) == "cdata" and right.type) or type (right)
                            local tx = _ret267
                            if tx == "string" then
                                right = tonumber (right)
                                if not right then
                                    _ret265, _ret266 = right, "Cannot convert the string value to a number."
                                    goto _inline_end638
                                end
                            elseif tx ~= "number" then
                                if tx == "table" and right.meta.table.tonumber then
                                    local meta = right.meta.table.tonumber
                                    local params = {}
                                    local _ret268
                                    table.insert (plume.runtime.callstack, {chunk = plume.runtime, macro = meta, ip = ip})
                                    if #plume.runtime.callstack <= 500 then
                                        local success, callResult, cip, source = plume.run (meta, params)
                                        if success then
                                            table.remove (plume.runtime.callstack)
                                            _ret268 = callResult
                                            goto _inline_end640
                                        else
                                            vmserr = {callResult, cip, (source or meta)}
                                        end
                                    else
                                        vmerr = plume.error.stackOverflow ()
                                    end
                                    ::_inline_end640::
                                    _ret265, _ret266 = _ret268
                                    goto _inline_end638
                                else
                                    _ret265, _ret266 = right, "Cannot do comparison or arithmetic with " .. tostring (tx) .. " value."
                                    goto _inline_end638
                                end
                            end
                            _ret265, _ret266 = right
                            goto _inline_end638
                        end
                        ::_inline_end638::
                        right, rerr = _ret265, _ret266
                        local _ret261, _ret262
                        do
                            local _ret263
                            _ret263 = type (left) == "table" and (left == empty or left.type) or (type (left) == "cdata" and left.type) or type (left)
                            local tx = _ret263
                            if tx == "string" then
                                left = tonumber (left)
                                if not left then
                                    _ret261, _ret262 = left, "Cannot convert the string value to a number."
                                    goto _inline_end633
                                end
                            elseif tx ~= "number" then
                                if tx == "table" and left.meta.table.tonumber then
                                    local meta = left.meta.table.tonumber
                                    local params = {}
                                    local _ret264
                                    table.insert (plume.runtime.callstack, {chunk = plume.runtime, macro = meta, ip = ip})
                                    if #plume.runtime.callstack <= 500 then
                                        local success, callResult, cip, source = plume.run (meta, params)
                                        if success then
                                            table.remove (plume.runtime.callstack)
                                            _ret264 = callResult
                                            goto _inline_end635
                                        else
                                            vmserr = {callResult, cip, (source or meta)}
                                        end
                                    else
                                        vmerr = plume.error.stackOverflow ()
                                    end
                                    ::_inline_end635::
                                    _ret261, _ret262 = _ret264
                                    goto _inline_end633
                                else
                                    _ret261, _ret262 = left, "Cannot do comparison or arithmetic with " .. tostring (tx) .. " value."
                                    goto _inline_end633
                                end
                            end
                            _ret261, _ret262 = left
                            goto _inline_end633
                        end
                        ::_inline_end633::
                        left, lerr = _ret261, _ret262
                        if lerr or rerr then
                            local _ret255
                            do
                                local meta, param1, param2, paramself
                                local _ret256
                                _ret256 = type (left) == "table" and (left == empty or left.type) or (type (left) == "cdata" and left.type) or type (left)
                                local tleft = _ret256
                                local _ret257
                                _ret257 = type (right) == "table" and (right == empty or right.type) or (type (right) == "cdata" and right.type) or type (right)
                                local tright = _ret257
                                if tleft == "table" and left.meta and left.meta.table.ltr then
                                    meta = left.meta.table.ltr
                                    param1 = right
                                    paramself = left
                                elseif tright == "table" and right.meta and right.meta.table.ltl then
                                    meta = right.meta.table.ltl
                                    param1 = left
                                    paramself = right
                                elseif tleft == "table" and left.meta and left.meta.table.lt then
                                    meta = left.meta.table.lt
                                    param1 = left
                                    param2 = right
                                    paramself = left
                                elseif tright == "table" and right.meta and right.meta.table.lt then
                                    meta = right.meta.table.lt
                                    param1 = left
                                    param2 = right
                                    paramself = right
                                end
                                if meta then
                                    mainStackFramesPointer = mainStackFramesPointer + 1
                                    mainStackFrames[mainStackFramesPointer] = mainStackPointer + 1
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = param1
                                    if param2 then
                                        mainStackPointer = mainStackPointer + 1
                                        mainStack[mainStackPointer] = param2
                                    end
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = paramself
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = "self"
                                    do
                                        local _ret258
                                        _ret258 = mainStackPointer
                                        local pos = _ret258
                                        tagStack[pos] = "key"
                                    end
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = meta
                                    do
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = plume.ops.CONCAT_CALL
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = 0
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = 0
                                        local _ret259
                                        _ret259 = macroStackPointer
                                        injectionStackPointer = injectionStackPointer + 1
                                        injectionStack[injectionStackPointer] = _ret259
                                    end
                                end
                                _ret255 = meta
                                goto _inline_end611
                            end
                            ::_inline_end611::
                            local meta = _ret255
                            if not meta then
                                vmerr = lerr or rerr
                            end
                        else
                            local _ret260
                            _ret260 = left < right
                            goto _inline_end632
                            ::_inline_end632::
                            result = _ret260
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = result
                        end
                    end
                end
                goto DISPATCH
            ::OP_EQ::
                do
                    local _ret269
                    mainStackPointer = mainStackPointer - 1
                    _ret269 = mainStack[mainStackPointer + 1]
                    local right = _ret269
                    local _ret270
                    mainStackPointer = mainStackPointer - 1
                    _ret270 = mainStack[mainStackPointer + 1]
                    local left = _ret270
                    local _ret271
                    do
                        local meta, param1, param2, paramself
                        local _ret272
                        _ret272 = type (left) == "table" and (left == empty or left.type) or (type (left) == "cdata" and left.type) or type (left)
                        local tleft = _ret272
                        local _ret273
                        _ret273 = type (right) == "table" and (right == empty or right.type) or (type (right) == "cdata" and right.type) or type (right)
                        local tright = _ret273
                        if tleft == "table" and left.meta and left.meta.table.eqr then
                            meta = left.meta.table.eqr
                            param1 = right
                            paramself = left
                        elseif tright == "table" and right.meta and right.meta.table.eql then
                            meta = right.meta.table.eql
                            param1 = left
                            paramself = right
                        elseif tleft == "table" and left.meta and left.meta.table.eq then
                            meta = left.meta.table.eq
                            param1 = left
                            param2 = right
                            paramself = left
                        elseif tright == "table" and right.meta and right.meta.table.eq then
                            meta = right.meta.table.eq
                            param1 = left
                            param2 = right
                            paramself = right
                        end
                        if meta then
                            mainStackFramesPointer = mainStackFramesPointer + 1
                            mainStackFrames[mainStackFramesPointer] = mainStackPointer + 1
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = param1
                            if param2 then
                                mainStackPointer = mainStackPointer + 1
                                mainStack[mainStackPointer] = param2
                            end
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = paramself
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = "self"
                            do
                                local _ret274
                                _ret274 = mainStackPointer
                                local pos = _ret274
                                tagStack[pos] = "key"
                            end
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = meta
                            do
                                injectionStackPointer = injectionStackPointer + 1
                                injectionStack[injectionStackPointer] = plume.ops.CONCAT_CALL
                                injectionStackPointer = injectionStackPointer + 1
                                injectionStack[injectionStackPointer] = 0
                                injectionStackPointer = injectionStackPointer + 1
                                injectionStack[injectionStackPointer] = 0
                                local _ret275
                                _ret275 = macroStackPointer
                                injectionStackPointer = injectionStackPointer + 1
                                injectionStack[injectionStackPointer] = _ret275
                            end
                        end
                        _ret271 = meta
                        goto _inline_end646
                    end
                    ::_inline_end646::
                    local meta = _ret271
                    if not meta then
                        local result = left == right or tonumber (left) and tonumber (left) == tonumber (right) or (false)
                        mainStackPointer = mainStackPointer + 1
                        mainStack[mainStackPointer] = result
                    end
                end
                goto DISPATCH
            ::OP_AND::
                do
                    local _ret276
                    mainStackPointer = mainStackPointer - 1
                    _ret276 = mainStack[mainStackPointer + 1]
                    local right = _ret276
                    local _ret277
                    mainStackPointer = mainStackPointer - 1
                    _ret277 = mainStack[mainStackPointer + 1]
                    local left = _ret277
                    local _ret278
                    if right == empty then
                        _ret278 = false
                        goto _inline_end670
                    end
                    _ret278 = right
                    ::_inline_end670::
                    right = _ret278
                    local _ret279
                    if left == empty then
                        _ret279 = false
                        goto _inline_end671
                    end
                    _ret279 = left
                    ::_inline_end671::
                    left = _ret279
                    local _ret280
                    _ret280 = right and left
                    mainStackPointer = mainStackPointer + 1
                    mainStack[mainStackPointer] = _ret280
                end
                goto DISPATCH
            ::OP_NOT::
                do
                    local _ret281
                    mainStackPointer = mainStackPointer - 1
                    _ret281 = mainStack[mainStackPointer + 1]
                    local x = _ret281
                    local _ret282
                    if x == empty then
                        _ret282 = false
                        goto _inline_end677
                    end
                    _ret282 = x
                    ::_inline_end677::
                    x = _ret282
                    local _ret283
                    _ret283 = not x
                    mainStackPointer = mainStackPointer + 1
                    mainStack[mainStackPointer] = _ret283
                end
                goto DISPATCH
            ::OP_OR::
                do
                    local _ret284
                    mainStackPointer = mainStackPointer - 1
                    _ret284 = mainStack[mainStackPointer + 1]
                    local right = _ret284
                    local _ret285
                    mainStackPointer = mainStackPointer - 1
                    _ret285 = mainStack[mainStackPointer + 1]
                    local left = _ret285
                    local _ret286
                    if right == empty then
                        _ret286 = false
                        goto _inline_end684
                    end
                    _ret286 = right
                    ::_inline_end684::
                    right = _ret286
                    local _ret287
                    if left == empty then
                        _ret287 = false
                        goto _inline_end685
                    end
                    _ret287 = left
                    ::_inline_end685::
                    left = _ret287
                    local _ret288
                    _ret288 = right or left
                    mainStackPointer = mainStackPointer + 1
                    mainStack[mainStackPointer] = _ret288
                end
                goto DISPATCH
            ::DUPLICATE::
                do
                    local _ret289
                    _ret289 = mainStack[mainStackPointer]
                    mainStackPointer = mainStackPointer + 1
                    mainStack[mainStackPointer] = _ret289
                end
                goto DISPATCH
            ::SWITCH::
                do
                    local _ret290
                    mainStackPointer = mainStackPointer - 1
                    _ret290 = mainStack[mainStackPointer + 1]
                    local x = _ret290
                    local _ret291
                    mainStackPointer = mainStackPointer - 1
                    _ret291 = mainStack[mainStackPointer + 1]
                    local y = _ret291
                    mainStackPointer = mainStackPointer + 1
                    mainStack[mainStackPointer] = x
                    mainStackPointer = mainStackPointer + 1
                    mainStack[mainStackPointer] = y
                end
                goto DISPATCH
            ::RETURN::
                do
                    do
                        local _ret292
                        variableStackFramesPointer = variableStackFramesPointer - 1
                        _ret292 = variableStackFrames[variableStackFramesPointer + 1]
                        variableStackPointer = _ret292 - 1
                    end
                    local _ret293
                    macroStackPointer = macroStackPointer - 1
                    _ret293 = macroStack[macroStackPointer + 1]
                    jump = _ret293
                end
                goto DISPATCH
            ::RETURN_FILE::
                RETURN_FILE (vm, arg1, arg2)
                goto DISPATCH
            ::STD_LEN::
                do
                    local _ret294
                    mainStackPointer = mainStackPointer - 1
                    _ret294 = mainStack[mainStackPointer + 1]
                    local t = _ret294.table[1]
                    local tt = type (t)
                    local result
                    if tt == "table" then
                        result = #t.table
                    elseif tt == "string" then
                        result = #t
                    else
                        vmerr = plume.error.hasNoLen (tt)
                    end
                    mainStackPointer = mainStackPointer + 1
                    mainStack[mainStackPointer] = result
                end
                goto DISPATCH
            ::STD_TYPE::
                do
                    local _ret295
                    mainStackPointer = mainStackPointer - 1
                    _ret295 = mainStack[mainStackPointer + 1]
                    local t = _ret295.table[1]
                    local _ret296
                    _ret296 = type (t) == "table" and (t == empty or t.type) or (type (t) == "cdata" and t.type) or type (t)
                    mainStackPointer = mainStackPointer + 1
                    mainStack[mainStackPointer] = _ret296
                end
                goto DISPATCH
            ::STD_SEQ::
                do
                    local _ret297
                    mainStackPointer = mainStackPointer - 1
                    _ret297 = mainStack[mainStackPointer + 1]
                    local args = _ret297.table
                    local start = args[1]
                    local stop = args[2]
                    local step = args[3] or 1
                    if not stop then
                        stop = start
                        start = 1
                    end
                    start = tonumber (start)
                    stop = tonumber (stop)
                    mainStackPointer = mainStackPointer + 1
                    mainStack[mainStackPointer] = {type = "stdIterator", start = start, stop = stop, step = step, flag = ITER_SEQ}
                end
                goto DISPATCH
            ::STD_ITEMS::
                do
                    local _ret298
                    mainStackPointer = mainStackPointer - 1
                    _ret298 = mainStack[mainStackPointer + 1]
                    local args = _ret298.table
                    mainStackPointer = mainStackPointer + 1
                    mainStack[mainStackPointer] = {type = "stdIterator", ref = args[1], flag = ITER_ITEMS, legacy = args.legacy}
                end
                goto DISPATCH
            ::STD_ENUMERATE::
                do
                    local _ret299
                    mainStackPointer = mainStackPointer - 1
                    _ret299 = mainStack[mainStackPointer + 1]
                    local args = _ret299.table
                    mainStackPointer = mainStackPointer + 1
                    mainStack[mainStackPointer] = {type = "stdIterator", ref = args[1], flag = ITER_ENUMS, legacy = args.legacy}
                end
                goto DISPATCH
            ::END::
            local _ret300
            _ret300 = mainStack[mainStackPointer]
            return true, _ret300
        end
    end
    