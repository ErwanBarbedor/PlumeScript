--[[This file is part of Plume

PlumeðŸª¶ is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, version 3 of the License.

PlumeðŸª¶ is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License along with PlumeðŸª¶.
If not, see <https://www.gnu.org/licenses/>.
]]

-- Generated by make-engine-opt.lua
-- It is an inlined and optimized version of engine.lua
return function (plume)
    function plume._run (chunk, arguments)
        require ("table.new")
        local chunk = chunk
        local bytecode = chunk.bytecode
        local constants = chunk.constants
        local static = chunk.static
        local ip = 0
        local tic = 0
        local mainStack = table.new (2 ^ 14, 0)
        local mainStackFrames = table.new (2 ^ 8, 0)
        local mainStackPointer = 0
        local mainStackFramesPointer = 0
        local variableStack = table.new (2 ^ 10, 0)
        local variableStackFrames = table.new (2 ^ 8, 0)
        local variableStackPointer = 0
        local variableStackFramesPointer = 0
        local jump = 0
        local empty = plume.obj.empty
        if arguments then
            if chunk.isFile then
                for k, v in pairs (arguments)
                 do
                    local offset = chunk.namedParamOffset[k]
                    if offset then
                        chunk.static[offset] = v
                    end
                end
            else
                for i = 1, chunk.localsCount do
                    if arguments[i] == nil then
                        variableStack[i] = empty
                    else
                        variableStack[i] = arguments[i]
                    end
                end
                variableStackPointer = chunk.localsCount
                variableStackFramesPointer = variableStackFramesPointer + 1
                variableStackFrames[variableStackFramesPointer] = 1
            end
        end
        local op, arg1, arg2, vmerr, vmserr
        ::DISPATCH::
            if vmerr then
                return false, vmerr, ip, chunk
            end
            if vmserr then
                return false, unpack (vmserr)
            end
            if jump > 0 then
                ip = jump
                jump = 0
            else
                ip = ip + 1
            end
            tic = tic + 1
            local _ret1, _ret2, _ret3
            do
                local bit = require ("bit")
                local OP_BITS = 7
                local ARG1_BITS = 5
                local ARG2_BITS = 20
                local ARG1_SHIFT = ARG2_BITS
                local OP_SHIFT = ARG1_BITS + ARG2_BITS
                local MASK_OP = bit.lshift (1, OP_BITS) - 1
                local MASK_ARG1 = bit.lshift (1, ARG1_BITS) - 1
                local MASK_ARG2 = bit.lshift (1, ARG2_BITS) - 1
                local instr, op, arg1, arg2
                instr = bytecode[ip]
                op = bit.band (bit.rshift (instr, OP_SHIFT)
                , MASK_OP)
                arg1 = bit.band (bit.rshift (instr, ARG1_SHIFT)
                , MASK_ARG1)
                arg2 = bit.band (instr, MASK_ARG2)
                _ret1, _ret2, _ret3 = op, arg1, arg2
                goto _inline_end9
            end
            ::_inline_end9::
            op, arg1, arg2 = _ret1, _ret2, _ret3
            if op == 1 then goto LOAD_CONSTANT
            elseif op == 2 then goto LOAD_TRUE
            elseif op == 3 then goto LOAD_FALSE
            elseif op == 4 then goto LOAD_EMPTY
            elseif op == 5 then goto LOAD_LOCAL
            elseif op == 6 then goto LOAD_STATIC
            elseif op == 7 then goto STORE_LOCAL
            elseif op == 8 then goto STORE_STATIC
            elseif op == 9 then goto STORE_VOID
            elseif op == 10 then goto TABLE_NEW
            elseif op == 11 then goto TABLE_SET
            elseif op == 12 then goto TABLE_INDEX
            elseif op == 13 then goto TABLE_INDEX_ACC_SELF
            elseif op == 14 then goto TABLE_SET_META
            elseif op == 15 then goto TABLE_SET_ACC
            elseif op == 16 then goto TABLE_EXPAND
            elseif op == 17 then goto ENTER_SCOPE
            elseif op == 18 then goto LEAVE_SCOPE
            elseif op == 19 then goto BEGIN_ACC
            elseif op == 20 then goto ACC_TABLE
            elseif op == 21 then goto ACC_TEXT
            elseif op == 22 then goto ACC_EMPTY
            elseif op == 23 then goto ACC_CALL
            elseif op == 24 then goto ACC_CHECK_TEXT
            elseif op == 25 then goto JUMP_IF
            elseif op == 26 then goto JUMP_IF_NOT
            elseif op == 27 then goto JUMP_IF_NOT_EMPTY
            elseif op == 28 then goto JUMP
            elseif op == 29 then goto JUMP_IF_PEEK
            elseif op == 30 then goto JUMP_IF_NOT_PEEK
            elseif op == 31 then goto GET_ITER
            elseif op == 32 then goto FOR_ITER
            elseif op == 33 then goto OPP_ADD
            elseif op == 34 then goto OPP_MUL
            elseif op == 35 then goto OPP_SUB
            elseif op == 36 then goto OPP_DIV
            elseif op == 37 then goto OPP_NEG
            elseif op == 38 then goto OPP_MOD
            elseif op == 39 then goto OPP_POW
            elseif op == 40 then goto OPP_LT
            elseif op == 41 then goto OPP_EQ
            elseif op == 42 then goto OPP_AND
            elseif op == 43 then goto OPP_NOT
            elseif op == 44 then goto OPP_OR
            elseif op == 45 then goto DUPLICATE
            elseif op == 46 then goto SWITCH
            elseif op == 47 then goto END
            end
            ::LOAD_CONSTANT::
                mainStackPointer = mainStackPointer + 1
                mainStack[mainStackPointer] = constants[arg2]
                goto DISPATCH
            ::LOAD_TRUE::
                mainStackPointer = mainStackPointer + 1
                mainStack[mainStackPointer] = true
                goto DISPATCH
            ::LOAD_FALSE::
                mainStackPointer = mainStackPointer + 1
                mainStack[mainStackPointer] = false
                goto DISPATCH
            ::LOAD_EMPTY::
                mainStackPointer = mainStackPointer + 1
                mainStack[mainStackPointer] = empty
                goto DISPATCH
            ::LOAD_LOCAL::
                do
                    local _ret4
                    do
                        local _ret5
                        _ret5 = variableStackFrames[variableStackFramesPointer + (-arg1 or 0)]
                        local _ret6
                        _ret6 = variableStack[_ret5 + (arg2 - 1 or 0) or variableStackPointer]
                        _ret4 = _ret6
                        goto _inline_end19
                    end
                    ::_inline_end19::
                    mainStackPointer = mainStackPointer + 1
                    mainStack[mainStackPointer] = _ret4
                end
                goto DISPATCH
            ::LOAD_STATIC::
                mainStackPointer = mainStackPointer + 1
                mainStack[mainStackPointer] = static[arg2]
                goto DISPATCH
            ::STORE_LOCAL::
                do
                    local _ret7
                    mainStackPointer = mainStackPointer - 1
                    _ret7 = mainStack[mainStackPointer + 1]
                    do
                        local _ret8
                        _ret8 = variableStackFrames[variableStackFramesPointer + -arg1 or 0]
                        variableStack[_ret8 + (arg2 - 1 or 0)] = _ret7
                    end
                end
                goto DISPATCH
            ::STORE_STATIC::
                do
                    local _ret9
                    mainStackPointer = mainStackPointer - 1
                    _ret9 = mainStack[mainStackPointer + 1]
                    static[arg2] = _ret9
                end
                goto DISPATCH
            ::STORE_VOID::
                do
                    local _ret10
                    mainStackPointer = mainStackPointer - 1
                    _ret10 = mainStack[mainStackPointer + 1]
                end
                goto DISPATCH
            ::TABLE_NEW::
                mainStackPointer = mainStackPointer + 1
                mainStack[mainStackPointer] = table.new (0, arg1)
                goto DISPATCH
            ::TABLE_SET::
                do
                    local _ret11
                    mainStackPointer = mainStackPointer - 1
                    _ret11 = mainStack[mainStackPointer + 1]
                    local t = _ret11
                    local _ret12
                    mainStackPointer = mainStackPointer - 1
                    _ret12 = mainStack[mainStackPointer + 1]
                    local key = _ret12
                    local _ret13
                    mainStackPointer = mainStackPointer - 1
                    _ret13 = mainStack[mainStackPointer + 1]
                    local value = _ret13
                    if not t.table[key] then
                        table.insert (t.keys, key)
                        if t.meta.table.setindex then
                            local meta = t.meta.table.setindex
                            local args = {key, value}
                            local _ret14
                            table.insert (chunk.callstack, {chunk = chunk, macro = meta, ip = ip})
                            if #chunk.callstack <= 1000 then
                                local success, callResult, cip, source = plume.run (meta, args)
                                if success then
                                    table.remove (chunk.callstack)
                                    _ret14 = callResult
                                    goto _inline_end40
                                else
                                    vmserr = {callResult, cip, (source or meta)}
                                end
                            else
                                vmerr = "stack overflow"
                            end
                            ::_inline_end40::
                            value = _ret14
                        end
                    end
                    key = tonumber (key) or key
                    t.table[key] = value
                end
                goto DISPATCH
            ::TABLE_INDEX::
                do
                    local _ret15
                    mainStackPointer = mainStackPointer - 1
                    _ret15 = mainStack[mainStackPointer + 1]
                    local t = _ret15
                    local _ret16
                    mainStackPointer = mainStackPointer - 1
                    _ret16 = mainStack[mainStackPointer + 1]
                    local key = _ret16
                    key = tonumber (key) or key
                    if key == empty then
                        if arg1 == 1 then
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = empty
                        else
                            vmerr = "Cannot use empty as key."
                        end
                    else
                        local _ret18
                        _ret18 = type (t) == "table" and (t == empty or t.type) or type (t)
                        goto _inline_end61
                        ::_inline_end61::
                        local tt = _ret18
                        if tt ~= "table" then
                            if arg1 == 1 then
                                mainStackPointer = mainStackPointer + 1
                                mainStack[mainStackPointer] = empty
                            else
                                vmerr = "Try to index a '" .. tt .. "' value."
                            end
                        else
                            local value = t.table[key]
                            if value then
                                mainStackPointer = mainStackPointer + 1
                                mainStack[mainStackPointer] = value
                            else
                                if arg1 == 1 then
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = empty
                                elseif t.meta.table.getindex then
                                    local meta = t.meta.table.getindex
                                    local args = {key}
                                    local _ret17
                                    table.insert (chunk.callstack, {chunk = chunk, macro = meta, ip = ip})
                                    if #chunk.callstack <= 1000 then
                                        local success, callResult, cip, source = plume.run (meta, args)
                                        if success then
                                            table.remove (chunk.callstack)
                                            _ret17 = callResult
                                            goto _inline_end55
                                        else
                                            vmserr = {callResult, cip, (source or meta)}
                                        end
                                    else
                                        vmerr = "stack overflow"
                                    end
                                    ::_inline_end55::
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = _ret17
                                else
                                    if tonumber (key)
                                     then
                                        vmerr = "Invalid index '" .. key .. "'."
                                    else
                                        vmerr = "Unregistered key '" .. key .. "'."
                                    end
                                end
                            end
                        end
                    end
                end
                goto DISPATCH
            ::TABLE_INDEX_ACC_SELF::
                do
                    local _ret19
                    do
                        local _ret20
                        _ret20 = mainStackFrames[mainStackFramesPointer]
                        local _ret21
                        _ret21 = mainStack[_ret20 or mainStackPointer]
                        _ret19 = _ret21
                        goto _inline_end63
                    end
                    ::_inline_end63::
                    local t = _ret19
                    table.insert (t, "self")
                    local _ret22
                    _ret22 = mainStack[mainStackPointer]
                    table.insert (t, _ret22)
                    table.insert (t, false)
                    do
                        local _ret23
                        mainStackPointer = mainStackPointer - 1
                        _ret23 = mainStack[mainStackPointer + 1]
                        local t = _ret23
                        local _ret24
                        mainStackPointer = mainStackPointer - 1
                        _ret24 = mainStack[mainStackPointer + 1]
                        local key = _ret24
                        key = tonumber (key) or key
                        if key == empty then
                            if false then
                                mainStackPointer = mainStackPointer + 1
                                mainStack[mainStackPointer] = empty
                            else
                                vmerr = "Cannot use empty as key."
                            end
                        else
                            local _ret26
                            _ret26 = type (t) == "table" and (t == empty or t.type) or type (t)
                            goto _inline_end85
                            ::_inline_end85::
                            local tt = _ret26
                            if tt ~= "table" then
                                if false then
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = empty
                                else
                                    vmerr = "Try to index a '" .. tt .. "' value."
                                end
                            else
                                local value = t.table[key]
                                if value then
                                    mainStackPointer = mainStackPointer + 1
                                    mainStack[mainStackPointer] = value
                                else
                                    if false then
                                        mainStackPointer = mainStackPointer + 1
                                        mainStack[mainStackPointer] = empty
                                    elseif t.meta.table.getindex then
                                        local meta = t.meta.table.getindex
                                        local args = {key}
                                        local _ret25
                                        table.insert (chunk.callstack, {chunk = chunk, macro = meta, ip = ip})
                                        if #chunk.callstack <= 1000 then
                                            local success, callResult, cip, source = plume.run (meta, args)
                                            if success then
                                                table.remove (chunk.callstack)
                                                _ret25 = callResult
                                                goto _inline_end79
                                            else
                                                vmserr = {callResult, cip, (source or meta)}
                                            end
                                        else
                                            vmerr = "stack overflow"
                                        end
                                        ::_inline_end79::
                                        mainStackPointer = mainStackPointer + 1
                                        mainStack[mainStackPointer] = _ret25
                                    else
                                        if tonumber (key)
                                         then
                                            vmerr = "Invalid index '" .. key .. "'."
                                        else
                                            vmerr = "Unregistered key '" .. key .. "'."
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
                goto DISPATCH
            ::TABLE_SET_META::
                do
                    local _ret27
                    mainStackPointer = mainStackPointer - 1
                    _ret27 = mainStack[mainStackPointer + 1]
                    local t = _ret27
                    local _ret28
                    mainStackPointer = mainStackPointer - 1
                    _ret28 = mainStack[mainStackPointer + 1]
                    local key = _ret28
                    local _ret29
                    mainStackPointer = mainStackPointer - 1
                    _ret29 = mainStack[mainStackPointer + 1]
                    local value = _ret29
                    t.meta.table[key] = value
                end
                goto DISPATCH
            ::TABLE_SET_ACC::
                do
                    local _ret30
                    do
                        local _ret31
                        _ret31 = mainStackFrames[mainStackFramesPointer]
                        local _ret32
                        _ret32 = mainStack[_ret31 or mainStackPointer]
                        _ret30 = _ret32
                        goto _inline_end91
                    end
                    ::_inline_end91::
                    local t = _ret30
                    local _ret33
                    mainStackPointer = mainStackPointer - 1
                    _ret33 = mainStack[mainStackPointer + 1]
                    table.insert (t, _ret33)
                    local _ret34
                    mainStackPointer = mainStackPointer - 1
                    _ret34 = mainStack[mainStackPointer + 1]
                    table.insert (t, _ret34)
                    table.insert (t, arg2 == 1)
                end
                goto DISPATCH
            ::TABLE_EXPAND::
                do
                    local _ret35
                    mainStackPointer = mainStackPointer - 1
                    _ret35 = mainStack[mainStackPointer + 1]
                    local t = _ret35
                    local _ret36
                    _ret36 = type (t) == "table" and (t == empty or t.type) or type (t)
                    local tt = _ret36
                    if tt == "table" then
                        for _, item in ipairs (t.table)
                         do
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = item
                        end
                        local _ret37
                        do
                            local _ret38
                            _ret38 = mainStackFrames[mainStackFramesPointer]
                            local _ret39
                            _ret39 = mainStack[_ret38 or mainStackPointer]
                            _ret37 = _ret39
                            goto _inline_end100
                        end
                        ::_inline_end100::
                        local ft = _ret37
                        for _, key in ipairs (t.keys)
                         do
                            table.insert (ft, key)
                            table.insert (ft, t.table[key])
                            table.insert (ft, false)
                        end
                    else
                        vmerr = "Try to expand a '" .. tt .. "' value."
                    end
                end
                goto DISPATCH
            ::ENTER_SCOPE::
                do
                    local _ret40
                    _ret40 = variableStackPointer
                    variableStackFramesPointer = variableStackFramesPointer + 1
                    variableStackFrames[variableStackFramesPointer] = _ret40 + 1 - arg1
                    for i = 1, arg2 - arg1 do
                        variableStackPointer = variableStackPointer + 1
                        variableStack[variableStackPointer] = empty
                    end
                end
                goto DISPATCH
            ::LEAVE_SCOPE::
                do
                    local _ret41
                    variableStackFramesPointer = variableStackFramesPointer - 1
                    _ret41 = variableStackFrames[variableStackFramesPointer + 1]
                    variableStackPointer = _ret41 - 1
                end
                goto DISPATCH
            ::BEGIN_ACC::
                mainStackFramesPointer = mainStackFramesPointer + 1
                mainStackFrames[mainStackFramesPointer] = mainStackPointer + 1
                goto DISPATCH
            ::ACC_TABLE::
                do
                    local _ret42
                    _ret42 = mainStackFrames[mainStackFramesPointer]
                    local limit = _ret42 + 1
                    local _ret43
                    _ret43 = mainStackPointer
                    local current = _ret43
                    local _ret44
                    _ret44 = mainStack[limit - 1 or mainStackPointer]
                    local t = _ret44
                    local keyCount = #t / 2
                    local args = plume.obj.table (current - limit + 1, keyCount)
                    for i = 1, current - limit + 1 do
                        local _ret45
                        _ret45 = mainStack[limit + i - 1 or mainStackPointer]
                        args.table[i] = _ret45
                    end
                    for i = 1, #t, 3 do
                        if t[i + 2] then
                            do
                                local _ret46, _ret47
                                do
                                    local comopps = "add mul div sub mod pow"
                                    local binopps = "eq lt"
                                    local unopps = "minus"
                                    local expectedParamCount
                                    for opp in comopps:gmatch ("%S+")
                                     do
                                        if t[i] == opp then
                                            expectedParamCount = 2
                                        elseif t[i]:match ("^" .. opp .. "[rl]")
                                             then
                                            expectedParamCount = 1
                                        end
                                    end
                                    for opp in binopps:gmatch ("%S+")
                                     do
                                        if t[i] == opp then
                                            expectedParamCount = 1
                                        end
                                    end
                                    for opp in unopps:gmatch ("%S+")
                                     do
                                        if t[i] == opp then
                                            expectedParamCount = 0
                                        end
                                    end
                                    if expectedParamCount then
                                        if t[i + 1].positionalParamCount ~= expectedParamCount then
                                            _ret46, _ret47 = false, "Wrong number of positionnal parameters for meta-macro '" .. t[i] .. "', " .. t[i + 1].positionalParamCount .. " instead of " .. expectedParamCount .. "."
                                            goto _inline_end120
                                        end
                                        if t[i + 1].namedParamCount > 1 then
                                            _ret46, _ret47 = false, "Meta-macro '" .. t[i] .. "' dont support named parameters."
                                            goto _inline_end120
                                        end
                                    elseif t[i] ~= "call" and t[i] ~= "tostring" and t[i] ~= "tonumber" and t[i] ~= "getindex" and t[i] ~= "setindex" and t[i] ~= "next" and t[i] ~= "iter" then
                                        _ret46, _ret47 = false, "'" .. t[i] .. "' isn't a valid meta-macro name."
                                        goto _inline_end120
                                    end
                                    _ret46, _ret47 = true
                                    goto _inline_end120
                                end
                                ::_inline_end120::
                                local success, err = _ret46, _ret47
                                if success then
                                    args.meta.table[t[i]] = t[i + 1]
                                else
                                    vmerr = err
                                end
                            end
                        else
                            do
                                local key = t[i]
                                local value = t[i + 1]
                                key = tonumber (key) or key
                                if not args.table[key] then
                                    table.insert (args.keys, t[i])
                                end
                                args.table[key] = value
                            end
                        end
                    end
                    mainStackPointer = limit - 2
                    mainStackPointer = mainStackPointer + 1
                    mainStack[mainStackPointer] = args
                    do
                        local _ret48
                        mainStackFramesPointer = mainStackFramesPointer - 1
                        _ret48 = mainStackFrames[mainStackFramesPointer + 1]
                    end
                end
                goto DISPATCH
            ::ACC_TEXT::
                do
                    local _ret49
                    _ret49 = mainStackFrames[mainStackFramesPointer]
                    local start = _ret49
                    local _ret50
                    _ret50 = mainStackPointer
                    local stop = _ret50
                    for i = start, stop do
                        local _ret51
                        _ret51 = mainStack[i or mainStackPointer]
                        if _ret51 == empty then
                            mainStack[i] = ""
                        end
                    end
                    local acc_text = table.concat (mainStack, "", start, stop)
                    mainStackPointer = start
                    mainStack[start] = acc_text
                    do
                        local _ret52
                        mainStackFramesPointer = mainStackFramesPointer - 1
                        _ret52 = mainStackFrames[mainStackFramesPointer + 1]
                    end
                end
                goto DISPATCH
            ::ACC_EMPTY::
                mainStackPointer = mainStackPointer + 1
                mainStack[mainStackPointer] = empty
                do
                    local _ret53
                    mainStackFramesPointer = mainStackFramesPointer - 1
                    _ret53 = mainStackFrames[mainStackFramesPointer + 1]
                end
                goto DISPATCH
            ::ACC_CALL::
                do
                    local _ret54
                    mainStackPointer = mainStackPointer - 1
                    _ret54 = mainStack[mainStackPointer + 1]
                    local tocall = _ret54
                    local _ret55
                    _ret55 = type (tocall) == "table" and (tocall == empty or tocall.type) or type (tocall)
                    local t = _ret55
                    local self
                    if t == "table" then
                        if tocall.meta and tocall.meta.table.call then
                            self = tocall
                            tocall = tocall.meta.table.call
                            t = tocall.type
                        end
                    end
                    if t == "macro" then
                        local capture = plume.obj.table (0, 0)
                        local arguments = {}
                        do
                            local _ret56
                            _ret56 = mainStackPointer
                            local _ret57
                            _ret57 = mainStackFrames[mainStackFramesPointer]
                            local argcount = _ret56 - _ret57
                            if argcount ~= tocall.positionalParamCount and tocall.variadicOffset == 0 then
                                local name
                                if chunk.mapping[ip - 1] then
                                    name = chunk.mapping[ip - 1].content
                                end
                                if not name then
                                    name = tocall.name or "???"
                                end
                                vmerr = "Wrong number of positionnal arguments for macro '" .. name .. "', " .. argcount .. " instead of " .. tocall.positionalParamCount .. "."
                            end
                            for i = 1, tocall.positionalParamCount do
                                local _ret58
                                _ret58 = mainStack[mainStackPointer + i - argcount]
                                arguments[i] = _ret58
                            end
                            for i = tocall.positionalParamCount + 1, argcount do
                                local _ret59
                                _ret59 = mainStack[mainStackPointer + i - argcount]
                                table.insert (capture.table, _ret59)
                            end
                            do
                                local _ret60
                                _ret60 = mainStackFrames[mainStackFramesPointer]
                                mainStackPointer = _ret60
                            end
                        end
                        do
                            local _ret61
                            do
                                local _ret62
                                _ret62 = mainStackFrames[mainStackFramesPointer]
                                local _ret63
                                _ret63 = mainStack[_ret62 or mainStackPointer]
                                _ret61 = _ret63
                                goto _inline_end153
                            end
                            ::_inline_end153::
                            local stack_bottom = _ret61
                            local err
                            for i = 1, #stack_bottom, 3 do
                                local k = stack_bottom[i]
                                local v = stack_bottom[i + 1]
                                local m = stack_bottom[i + 2]
                                local j = tocall.namedParamOffset[k]
                                if m then
                                    do
                                        local _ret64, _ret65
                                        do
                                            local comopps = "add mul div sub mod pow"
                                            local binopps = "eq lt"
                                            local unopps = "minus"
                                            local expectedParamCount
                                            for opp in comopps:gmatch ("%S+")
                                             do
                                                if k == opp then
                                                    expectedParamCount = 2
                                                elseif k:match ("^" .. opp .. "[rl]")
                                                     then
                                                    expectedParamCount = 1
                                                end
                                            end
                                            for opp in binopps:gmatch ("%S+")
                                             do
                                                if k == opp then
                                                    expectedParamCount = 1
                                                end
                                            end
                                            for opp in unopps:gmatch ("%S+")
                                             do
                                                if k == opp then
                                                    expectedParamCount = 0
                                                end
                                            end
                                            if expectedParamCount then
                                                if v.positionalParamCount ~= expectedParamCount then
                                                    _ret64, _ret65 = false, "Wrong number of positionnal parameters for meta-macro '" .. k .. "', " .. v.positionalParamCount .. " instead of " .. expectedParamCount .. "."
                                                    goto _inline_end157
                                                end
                                                if v.namedParamCount > 1 then
                                                    _ret64, _ret65 = false, "Meta-macro '" .. k .. "' dont support named parameters."
                                                    goto _inline_end157
                                                end
                                            elseif k ~= "call" and k ~= "tostring" and k ~= "tonumber" and k ~= "getindex" and k ~= "setindex" and k ~= "next" and k ~= "iter" then
                                                _ret64, _ret65 = false, "'" .. k .. "' isn't a valid meta-macro name."
                                                goto _inline_end157
                                            end
                                            _ret64, _ret65 = true
                                            goto _inline_end157
                                        end
                                        ::_inline_end157::
                                        local success, err = _ret64, _ret65
                                        if success then
                                            capture.meta.table[k] = v
                                        else
                                            vmerr = err
                                        end
                                    end
                                elseif j then
                                    arguments[j] = v
                                elseif tocall.variadicOffset > 0 then
                                    do
                                        local key = k
                                        local value = v
                                        key = tonumber (key) or key
                                        if not capture.table[key] then
                                            table.insert (capture.keys, k)
                                        end
                                        capture.table[key] = value
                                    end
                                else
                                    local name = tocall.name or "???"
                                    err = "Unknow named parameter '" .. k .. "' for macro '" .. name .. "'."
                                end
                            end
                            if err then
                                vmerr = err
                            else
                                local _ret66
                                mainStackPointer = mainStackPointer - 1
                                _ret66 = mainStack[mainStackPointer + 1]
                                goto _inline_end161
                                ::_inline_end161::
                            end
                        end
                        if self then
                            table.insert (arguments, self)
                        end
                        if tocall.variadicOffset > 0 then
                            arguments[tocall.variadicOffset] = capture
                        end
                        do
                            local _ret67
                            mainStackFramesPointer = mainStackFramesPointer - 1
                            _ret67 = mainStackFrames[mainStackFramesPointer + 1]
                        end
                        local _ret68
                        table.insert (chunk.callstack, {chunk = chunk, macro = tocall, ip = ip})
                        if #chunk.callstack <= 1000 then
                            local success, callResult, cip, source = plume.run (tocall, arguments)
                            if success then
                                table.remove (chunk.callstack)
                                _ret68 = callResult
                                goto _inline_end164
                            else
                                vmserr = {callResult, cip, (source or tocall)}
                            end
                        else
                            vmerr = "stack overflow"
                        end
                        ::_inline_end164::
                        mainStackPointer = mainStackPointer + 1
                        mainStack[mainStackPointer] = _ret68
                    elseif t == "luaFunction" then
                        do
                            local _ret69
                            _ret69 = mainStackFrames[mainStackFramesPointer]
                            local limit = _ret69 + 1
                            local _ret70
                            _ret70 = mainStackPointer
                            local current = _ret70
                            local _ret71
                            _ret71 = mainStack[limit - 1 or mainStackPointer]
                            local t = _ret71
                            local keyCount = #t / 2
                            local args = plume.obj.table (current - limit + 1, keyCount)
                            for i = 1, current - limit + 1 do
                                local _ret72
                                _ret72 = mainStack[limit + i - 1 or mainStackPointer]
                                args.table[i] = _ret72
                            end
                            for i = 1, #t, 3 do
                                if t[i + 2] then
                                    do
                                        local _ret73, _ret74
                                        do
                                            local comopps = "add mul div sub mod pow"
                                            local binopps = "eq lt"
                                            local unopps = "minus"
                                            local expectedParamCount
                                            for opp in comopps:gmatch ("%S+")
                                             do
                                                if t[i] == opp then
                                                    expectedParamCount = 2
                                                elseif t[i]:match ("^" .. opp .. "[rl]")
                                                     then
                                                    expectedParamCount = 1
                                                end
                                            end
                                            for opp in binopps:gmatch ("%S+")
                                             do
                                                if t[i] == opp then
                                                    expectedParamCount = 1
                                                end
                                            end
                                            for opp in unopps:gmatch ("%S+")
                                             do
                                                if t[i] == opp then
                                                    expectedParamCount = 0
                                                end
                                            end
                                            if expectedParamCount then
                                                if t[i + 1].positionalParamCount ~= expectedParamCount then
                                                    _ret73, _ret74 = false, "Wrong number of positionnal parameters for meta-macro '" .. t[i] .. "', " .. t[i + 1].positionalParamCount .. " instead of " .. expectedParamCount .. "."
                                                    goto _inline_end174
                                                end
                                                if t[i + 1].namedParamCount > 1 then
                                                    _ret73, _ret74 = false, "Meta-macro '" .. t[i] .. "' dont support named parameters."
                                                    goto _inline_end174
                                                end
                                            elseif t[i] ~= "call" and t[i] ~= "tostring" and t[i] ~= "tonumber" and t[i] ~= "getindex" and t[i] ~= "setindex" and t[i] ~= "next" and t[i] ~= "iter" then
                                                _ret73, _ret74 = false, "'" .. t[i] .. "' isn't a valid meta-macro name."
                                                goto _inline_end174
                                            end
                                            _ret73, _ret74 = true
                                            goto _inline_end174
                                        end
                                        ::_inline_end174::
                                        local success, err = _ret73, _ret74
                                        if success then
                                            args.meta.table[t[i]] = t[i + 1]
                                        else
                                            vmerr = err
                                        end
                                    end
                                else
                                    do
                                        local key = t[i]
                                        local value = t[i + 1]
                                        key = tonumber (key) or key
                                        if not args.table[key] then
                                            table.insert (args.keys, t[i])
                                        end
                                        args.table[key] = value
                                    end
                                end
                            end
                            mainStackPointer = limit - 2
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = args
                            do
                                local _ret75
                                mainStackFramesPointer = mainStackFramesPointer - 1
                                _ret75 = mainStackFrames[mainStackFramesPointer + 1]
                            end
                        end
                        table.insert (chunk.callstack, {chunk = chunk, macro = tocall, ip = ip})
                        local _ret76
                        _ret76 = mainStack[mainStackPointer]
                        local success, result = pcall (tocall.callable, _ret76, chunk)
                        if success then
                            table.remove (chunk.callstack)
                            if result == nil then
                                result = empty
                            end
                            local _ret77
                            mainStackPointer = mainStackPointer - 1
                            _ret77 = mainStack[mainStackPointer + 1]
                            mainStackPointer = mainStackPointer + 1
                            mainStack[mainStackPointer] = result
                        else
                            vmerr = result
                        end
                    else
                        vmerr = "Try to call a '" .. t .. "' value"
                    end
                end
                goto DISPATCH
            ::ACC_CHECK_TEXT::
                do
                    local _ret78
                    _ret78 = mainStack[mainStackPointer]
                    local value = _ret78
                    local _ret79
                    _ret79 = type (value) == "table" and (value == empty or value.type) or type (value)
                    local t = _ret79
                    if t ~= "number" and t ~= "string" and value ~= empty then
                        if t == "table" and value.meta.table.tostring then
                            local meta = value.meta.table.tostring
                            local args = {}
                            local _ret80
                            table.insert (chunk.callstack, {chunk = chunk, macro = meta, ip = ip})
                            if #chunk.callstack <= 1000 then
                                local success, callResult, cip, source = plume.run (meta, args)
                                if success then
                                    table.remove (chunk.callstack)
                                    _ret80 = callResult
                                    goto _inline_end189
                                else
                                    vmserr = {callResult, cip, (source or meta)}
                                end
                            else
                                vmerr = "stack overflow"
                            end
                            ::_inline_end189::
                            local _ret81
                            _ret81 = mainStackPointer
                            mainStack[_ret81] = _ret80
                        else
                            vmerr = "Cannot concat a '" .. t .. "' value."
                        end
                    end
                end
                goto DISPATCH
            ::JUMP_IF::
                do
                    local _ret82
                    mainStackPointer = mainStackPointer - 1
                    _ret82 = mainStack[mainStackPointer + 1]
                    local test = _ret82
                    local _ret83
                    if test == empty then
                        _ret83 = false
                        goto _inline_end197
                    end
                    _ret83 = test
                    ::_inline_end197::
                    if _ret83 then
                        jump = arg2
                    end
                end
                goto DISPATCH
            ::JUMP_IF_NOT::
                do
                    local _ret84
                    mainStackPointer = mainStackPointer - 1
                    _ret84 = mainStack[mainStackPointer + 1]
                    local test = _ret84
                    local _ret85
                    if test == empty then
                        _ret85 = false
                        goto _inline_end200
                    end
                    _ret85 = test
                    ::_inline_end200::
                    if not _ret85 then
                        jump = arg2
                    end
                end
                goto DISPATCH
            ::JUMP_IF_NOT_EMPTY::
                do
                    local _ret86
                    mainStackPointer = mainStackPointer - 1
                    _ret86 = mainStack[mainStackPointer + 1]
                    local test = _ret86
                    if test ~= empty then
                        jump = arg2
                    end
                end
                goto DISPATCH
            ::JUMP::
                jump = arg2
                goto DISPATCH
            ::JUMP_IF_PEEK::
                do
                    local _ret87
                    _ret87 = mainStack[mainStackPointer]
                    local test = _ret87
                    local _ret88
                    if test == empty then
                        _ret88 = false
                        goto _inline_end206
                    end
                    _ret88 = test
                    ::_inline_end206::
                    if _ret88 then
                        jump = arg2
                    end
                end
                goto DISPATCH
            ::JUMP_IF_NOT_PEEK::
                do
                    local _ret89
                    _ret89 = mainStack[mainStackPointer]
                    local test = _ret89
                    local _ret90
                    if test == empty then
                        _ret90 = false
                        goto _inline_end209
                    end
                    _ret90 = test
                    ::_inline_end209::
                    if not _ret90 then
                        jump = arg2
                    end
                end
                goto DISPATCH
            ::GET_ITER::
                do
                    local _ret91
                    mainStackPointer = mainStackPointer - 1
                    _ret91 = mainStack[mainStackPointer + 1]
                    local obj = _ret91
                    local _ret92
                    _ret92 = type (obj) == "table" and (obj == empty or obj.type) or type (obj)
                    local tobj = _ret92
                    if tobj == "table" then
                        local iter
                        if obj.meta.table.next then
                            iter = obj
                        else
                            iter = obj.meta.table.iter or plume.defaultMeta.iter
                        end
                        local value
                        if iter.type == "luaFunction" then
                            value = iter.callable ({obj})
                        elseif iter.type == "table" then
                            value = iter
                        elseif iter.type == "macro" then
                            local _ret93
                            table.insert (chunk.callstack, {chunk = chunk, macro = iter, ip = ip})
                            if #chunk.callstack <= 1000 then
                                local success, callResult, cip, source = plume.run (iter, {obj})
                                if success then
                                    table.remove (chunk.callstack)
                                    _ret93 = callResult
                                    goto _inline_end213
                                else
                                    vmserr = {callResult, cip, (source or iter)}
                                end
                            else
                                vmerr = "stack overflow"
                            end
                            ::_inline_end213::
                            value = _ret93
                        end
                        mainStackPointer = mainStackPointer + 1
                        mainStack[mainStackPointer] = value
                    else
                        vmerr = "Try to iterate over a non-table '" .. tobj .. "' value."
                    end
                end
                goto DISPATCH
            ::FOR_ITER::
                do
                    local _ret94
                    mainStackPointer = mainStackPointer - 1
                    _ret94 = mainStack[mainStackPointer + 1]
                    local obj = _ret94
                    local iter = obj.meta.table.next
                    local result
                    if iter.type == "luaFunction" then
                        result = iter.callable ()
                    else
                        local _ret95
                        table.insert (chunk.callstack, {chunk = chunk, macro = iter, ip = ip})
                        if #chunk.callstack <= 1000 then
                            local success, callResult, cip, source = plume.run (iter, {obj})
                            if success then
                                table.remove (chunk.callstack)
                                _ret95 = callResult
                                goto _inline_end220
                            else
                                vmserr = {callResult, cip, (source or iter)}
                            end
                        else
                            vmerr = "stack overflow"
                        end
                        ::_inline_end220::
                        result = _ret95
                    end
                    if result == empty then
                        jump = arg2
                    else
                        mainStackPointer = mainStackPointer + 1
                        mainStack[mainStackPointer] = result
                    end
                end
                goto DISPATCH
            ::OPP_ADD::
                do
                    local _ret96
                    mainStackPointer = mainStackPointer - 1
                    _ret96 = mainStack[mainStackPointer + 1]
                    local right = _ret96
                    local _ret97
                    mainStackPointer = mainStackPointer - 1
                    _ret97 = mainStack[mainStackPointer + 1]
                    local left = _ret97
                    local rerr, lerr, success, result
                    local _ret98, _ret99
                    do
                        local _ret100
                        _ret100 = type (right) == "table" and (right == empty or right.type) or type (right)
                        local tx = _ret100
                        if tx == "string" then
                            right = tonumber (right)
                            if not right then
                                _ret98, _ret99 = right, "Cannot convert the string value to a number."
                                goto _inline_end229
                            end
                        elseif tx ~= "number" then
                            if tx == "table" and right.meta.table.tonumber then
                                local meta = right.meta.table.tonumber
                                local params = {}
                                local _ret101
                                table.insert (chunk.callstack, {chunk = chunk, macro = meta, ip = ip})
                                if #chunk.callstack <= 1000 then
                                    local success, callResult, cip, source = plume.run (meta, params)
                                    if success then
                                        table.remove (chunk.callstack)
                                        _ret101 = callResult
                                        goto _inline_end231
                                    else
                                        vmserr = {callResult, cip, (source or meta)}
                                    end
                                else
                                    vmerr = "stack overflow"
                                end
                                ::_inline_end231::
                                _ret98, _ret99 = _ret101
                                goto _inline_end229
                            else
                                _ret98, _ret99 = right, "Cannot do comparison or arithmetic with " .. tostring (tx) .. " value."
                                goto _inline_end229
                            end
                        end
                        _ret98, _ret99 = right
                        goto _inline_end229
                    end
                    ::_inline_end229::
                    right, rerr = _ret98, _ret99
                    local _ret102, _ret103
                    do
                        local _ret104
                        _ret104 = type (left) == "table" and (left == empty or left.type) or type (left)
                        local tx = _ret104
                        if tx == "string" then
                            left = tonumber (left)
                            if not left then
                                _ret102, _ret103 = left, "Cannot convert the string value to a number."
                                goto _inline_end234
                            end
                        elseif tx ~= "number" then
                            if tx == "table" and left.meta.table.tonumber then
                                local meta = left.meta.table.tonumber
                                local params = {}
                                local _ret105
                                table.insert (chunk.callstack, {chunk = chunk, macro = meta, ip = ip})
                                if #chunk.callstack <= 1000 then
                                    local success, callResult, cip, source = plume.run (meta, params)
                                    if success then
                                        table.remove (chunk.callstack)
                                        _ret105 = callResult
                                        goto _inline_end236
                                    else
                                        vmserr = {callResult, cip, (source or meta)}
                                    end
                                else
                                    vmerr = "stack overflow"
                                end
                                ::_inline_end236::
                                _ret102, _ret103 = _ret105
                                goto _inline_end234
                            else
                                _ret102, _ret103 = left, "Cannot do comparison or arithmetic with " .. tostring (tx) .. " value."
                                goto _inline_end234
                            end
                        end
                        _ret102, _ret103 = left
                        goto _inline_end234
                    end
                    ::_inline_end234::
                    left, lerr = _ret102, _ret103
                    if lerr or rerr then
                        local _ret106, _ret107
                        do
                            local meta, params
                            local _ret108
                            _ret108 = type (left) == "table" and (left == empty or left.type) or type (left)
                            local tleft = _ret108
                            local _ret109
                            _ret109 = type (right) == "table" and (right == empty or right.type) or type (right)
                            local tright = _ret109
                            if tleft == "table" and left.meta and left.meta.table["add" .. "r"] then
                                meta = left.meta.table["add" .. "r"]
                                params = {right, left}
                            elseif tright == "table" and right.meta and right.meta.table["add" .. "l"] then
                                meta = right.meta.table["add" .. "l"]
                                params = {left, right}
                            elseif tleft == "table" and left.meta and left.meta.table.add then
                                meta = left.meta.table.add
                                params = {left, right, left}
                            elseif tright == "table" and right.meta and right.meta.table.add then
                                meta = right.meta.table.add
                                params = {left, right, right}
                            end
                            if not meta then
                                _ret106 = false
                                goto _inline_end239
                            end
                            local _ret110
                            table.insert (chunk.callstack, {chunk = chunk, macro = meta, ip = ip})
                            if #chunk.callstack <= 1000 then
                                local success, callResult, cip, source = plume.run (meta, params)
                                if success then
                                    table.remove (chunk.callstack)
                                    _ret110 = callResult
                                    goto _inline_end242
                                else
                                    vmserr = {callResult, cip, (source or meta)}
                                end
                            else
                                vmerr = "stack overflow"
                            end
                            ::_inline_end242::
                            _ret106, _ret107 = true, _ret110
                            goto _inline_end239
                        end
                        ::_inline_end239::
                        success, result = _ret106, _ret107
                    else
                        success = true
                        local _ret111
                        _ret111 = left + right
                        goto _inline_end245
                        ::_inline_end245::
                        result = _ret111
                    end
                    if success then
                        mainStackPointer = mainStackPointer + 1
                        mainStack[mainStackPointer] = result
                    else
                        vmerr = lerr or rerr
                    end
                end
                goto DISPATCH
            ::OPP_MUL::
                do
                    local _ret112
                    mainStackPointer = mainStackPointer - 1
                    _ret112 = mainStack[mainStackPointer + 1]
                    local right = _ret112
                    local _ret113
                    mainStackPointer = mainStackPointer - 1
                    _ret113 = mainStack[mainStackPointer + 1]
                    local left = _ret113
                    local rerr, lerr, success, result
                    local _ret114, _ret115
                    do
                        local _ret116
                        _ret116 = type (right) == "table" and (right == empty or right.type) or type (right)
                        local tx = _ret116
                        if tx == "string" then
                            right = tonumber (right)
                            if not right then
                                _ret114, _ret115 = right, "Cannot convert the string value to a number."
                                goto _inline_end252
                            end
                        elseif tx ~= "number" then
                            if tx == "table" and right.meta.table.tonumber then
                                local meta = right.meta.table.tonumber
                                local params = {}
                                local _ret117
                                table.insert (chunk.callstack, {chunk = chunk, macro = meta, ip = ip})
                                if #chunk.callstack <= 1000 then
                                    local success, callResult, cip, source = plume.run (meta, params)
                                    if success then
                                        table.remove (chunk.callstack)
                                        _ret117 = callResult
                                        goto _inline_end254
                                    else
                                        vmserr = {callResult, cip, (source or meta)}
                                    end
                                else
                                    vmerr = "stack overflow"
                                end
                                ::_inline_end254::
                                _ret114, _ret115 = _ret117
                                goto _inline_end252
                            else
                                _ret114, _ret115 = right, "Cannot do comparison or arithmetic with " .. tostring (tx) .. " value."
                                goto _inline_end252
                            end
                        end
                        _ret114, _ret115 = right
                        goto _inline_end252
                    end
                    ::_inline_end252::
                    right, rerr = _ret114, _ret115
                    local _ret118, _ret119
                    do
                        local _ret120
                        _ret120 = type (left) == "table" and (left == empty or left.type) or type (left)
                        local tx = _ret120
                        if tx == "string" then
                            left = tonumber (left)
                            if not left then
                                _ret118, _ret119 = left, "Cannot convert the string value to a number."
                                goto _inline_end257
                            end
                        elseif tx ~= "number" then
                            if tx == "table" and left.meta.table.tonumber then
                                local meta = left.meta.table.tonumber
                                local params = {}
                                local _ret121
                                table.insert (chunk.callstack, {chunk = chunk, macro = meta, ip = ip})
                                if #chunk.callstack <= 1000 then
                                    local success, callResult, cip, source = plume.run (meta, params)
                                    if success then
                                        table.remove (chunk.callstack)
                                        _ret121 = callResult
                                        goto _inline_end259
                                    else
                                        vmserr = {callResult, cip, (source or meta)}
                                    end
                                else
                                    vmerr = "stack overflow"
                                end
                                ::_inline_end259::
                                _ret118, _ret119 = _ret121
                                goto _inline_end257
                            else
                                _ret118, _ret119 = left, "Cannot do comparison or arithmetic with " .. tostring (tx) .. " value."
                                goto _inline_end257
                            end
                        end
                        _ret118, _ret119 = left
                        goto _inline_end257
                    end
                    ::_inline_end257::
                    left, lerr = _ret118, _ret119
                    if lerr or rerr then
                        local _ret122, _ret123
                        do
                            local meta, params
                            local _ret124
                            _ret124 = type (left) == "table" and (left == empty or left.type) or type (left)
                            local tleft = _ret124
                            local _ret125
                            _ret125 = type (right) == "table" and (right == empty or right.type) or type (right)
                            local tright = _ret125
                            if tleft == "table" and left.meta and left.meta.table["mul" .. "r"] then
                                meta = left.meta.table["mul" .. "r"]
                                params = {right, left}
                            elseif tright == "table" and right.meta and right.meta.table["mul" .. "l"] then
                                meta = right.meta.table["mul" .. "l"]
                                params = {left, right}
                            elseif tleft == "table" and left.meta and left.meta.table.mul then
                                meta = left.meta.table.mul
                                params = {left, right, left}
                            elseif tright == "table" and right.meta and right.meta.table.mul then
                                meta = right.meta.table.mul
                                params = {left, right, right}
                            end
                            if not meta then
                                _ret122 = false
                                goto _inline_end262
                            end
                            local _ret126
                            table.insert (chunk.callstack, {chunk = chunk, macro = meta, ip = ip})
                            if #chunk.callstack <= 1000 then
                                local success, callResult, cip, source = plume.run (meta, params)
                                if success then
                                    table.remove (chunk.callstack)
                                    _ret126 = callResult
                                    goto _inline_end265
                                else
                                    vmserr = {callResult, cip, (source or meta)}
                                end
                            else
                                vmerr = "stack overflow"
                            end
                            ::_inline_end265::
                            _ret122, _ret123 = true, _ret126
                            goto _inline_end262
                        end
                        ::_inline_end262::
                        success, result = _ret122, _ret123
                    else
                        success = true
                        local _ret127
                        _ret127 = left * right
                        goto _inline_end268
                        ::_inline_end268::
                        result = _ret127
                    end
                    if success then
                        mainStackPointer = mainStackPointer + 1
                        mainStack[mainStackPointer] = result
                    else
                        vmerr = lerr or rerr
                    end
                end
                goto DISPATCH
            ::OPP_SUB::
                do
                    local _ret128
                    mainStackPointer = mainStackPointer - 1
                    _ret128 = mainStack[mainStackPointer + 1]
                    local right = _ret128
                    local _ret129
                    mainStackPointer = mainStackPointer - 1
                    _ret129 = mainStack[mainStackPointer + 1]
                    local left = _ret129
                    local rerr, lerr, success, result
                    local _ret130, _ret131
                    do
                        local _ret132
                        _ret132 = type (right) == "table" and (right == empty or right.type) or type (right)
                        local tx = _ret132
                        if tx == "string" then
                            right = tonumber (right)
                            if not right then
                                _ret130, _ret131 = right, "Cannot convert the string value to a number."
                                goto _inline_end275
                            end
                        elseif tx ~= "number" then
                            if tx == "table" and right.meta.table.tonumber then
                                local meta = right.meta.table.tonumber
                                local params = {}
                                local _ret133
                                table.insert (chunk.callstack, {chunk = chunk, macro = meta, ip = ip})
                                if #chunk.callstack <= 1000 then
                                    local success, callResult, cip, source = plume.run (meta, params)
                                    if success then
                                        table.remove (chunk.callstack)
                                        _ret133 = callResult
                                        goto _inline_end277
                                    else
                                        vmserr = {callResult, cip, (source or meta)}
                                    end
                                else
                                    vmerr = "stack overflow"
                                end
                                ::_inline_end277::
                                _ret130, _ret131 = _ret133
                                goto _inline_end275
                            else
                                _ret130, _ret131 = right, "Cannot do comparison or arithmetic with " .. tostring (tx) .. " value."
                                goto _inline_end275
                            end
                        end
                        _ret130, _ret131 = right
                        goto _inline_end275
                    end
                    ::_inline_end275::
                    right, rerr = _ret130, _ret131
                    local _ret134, _ret135
                    do
                        local _ret136
                        _ret136 = type (left) == "table" and (left == empty or left.type) or type (left)
                        local tx = _ret136
                        if tx == "string" then
                            left = tonumber (left)
                            if not left then
                                _ret134, _ret135 = left, "Cannot convert the string value to a number."
                                goto _inline_end280
                            end
                        elseif tx ~= "number" then
                            if tx == "table" and left.meta.table.tonumber then
                                local meta = left.meta.table.tonumber
                                local params = {}
                                local _ret137
                                table.insert (chunk.callstack, {chunk = chunk, macro = meta, ip = ip})
                                if #chunk.callstack <= 1000 then
                                    local success, callResult, cip, source = plume.run (meta, params)
                                    if success then
                                        table.remove (chunk.callstack)
                                        _ret137 = callResult
                                        goto _inline_end282
                                    else
                                        vmserr = {callResult, cip, (source or meta)}
                                    end
                                else
                                    vmerr = "stack overflow"
                                end
                                ::_inline_end282::
                                _ret134, _ret135 = _ret137
                                goto _inline_end280
                            else
                                _ret134, _ret135 = left, "Cannot do comparison or arithmetic with " .. tostring (tx) .. " value."
                                goto _inline_end280
                            end
                        end
                        _ret134, _ret135 = left
                        goto _inline_end280
                    end
                    ::_inline_end280::
                    left, lerr = _ret134, _ret135
                    if lerr or rerr then
                        local _ret138, _ret139
                        do
                            local meta, params
                            local _ret140
                            _ret140 = type (left) == "table" and (left == empty or left.type) or type (left)
                            local tleft = _ret140
                            local _ret141
                            _ret141 = type (right) == "table" and (right == empty or right.type) or type (right)
                            local tright = _ret141
                            if tleft == "table" and left.meta and left.meta.table["sub" .. "r"] then
                                meta = left.meta.table["sub" .. "r"]
                                params = {right, left}
                            elseif tright == "table" and right.meta and right.meta.table["sub" .. "l"] then
                                meta = right.meta.table["sub" .. "l"]
                                params = {left, right}
                            elseif tleft == "table" and left.meta and left.meta.table.sub then
                                meta = left.meta.table.sub
                                params = {left, right, left}
                            elseif tright == "table" and right.meta and right.meta.table.sub then
                                meta = right.meta.table.sub
                                params = {left, right, right}
                            end
                            if not meta then
                                _ret138 = false
                                goto _inline_end285
                            end
                            local _ret142
                            table.insert (chunk.callstack, {chunk = chunk, macro = meta, ip = ip})
                            if #chunk.callstack <= 1000 then
                                local success, callResult, cip, source = plume.run (meta, params)
                                if success then
                                    table.remove (chunk.callstack)
                                    _ret142 = callResult
                                    goto _inline_end288
                                else
                                    vmserr = {callResult, cip, (source or meta)}
                                end
                            else
                                vmerr = "stack overflow"
                            end
                            ::_inline_end288::
                            _ret138, _ret139 = true, _ret142
                            goto _inline_end285
                        end
                        ::_inline_end285::
                        success, result = _ret138, _ret139
                    else
                        success = true
                        local _ret143
                        _ret143 = left - right
                        goto _inline_end291
                        ::_inline_end291::
                        result = _ret143
                    end
                    if success then
                        mainStackPointer = mainStackPointer + 1
                        mainStack[mainStackPointer] = result
                    else
                        vmerr = lerr or rerr
                    end
                end
                goto DISPATCH
            ::OPP_DIV::
                do
                    local _ret144
                    mainStackPointer = mainStackPointer - 1
                    _ret144 = mainStack[mainStackPointer + 1]
                    local right = _ret144
                    local _ret145
                    mainStackPointer = mainStackPointer - 1
                    _ret145 = mainStack[mainStackPointer + 1]
                    local left = _ret145
                    local rerr, lerr, success, result
                    local _ret146, _ret147
                    do
                        local _ret148
                        _ret148 = type (right) == "table" and (right == empty or right.type) or type (right)
                        local tx = _ret148
                        if tx == "string" then
                            right = tonumber (right)
                            if not right then
                                _ret146, _ret147 = right, "Cannot convert the string value to a number."
                                goto _inline_end298
                            end
                        elseif tx ~= "number" then
                            if tx == "table" and right.meta.table.tonumber then
                                local meta = right.meta.table.tonumber
                                local params = {}
                                local _ret149
                                table.insert (chunk.callstack, {chunk = chunk, macro = meta, ip = ip})
                                if #chunk.callstack <= 1000 then
                                    local success, callResult, cip, source = plume.run (meta, params)
                                    if success then
                                        table.remove (chunk.callstack)
                                        _ret149 = callResult
                                        goto _inline_end300
                                    else
                                        vmserr = {callResult, cip, (source or meta)}
                                    end
                                else
                                    vmerr = "stack overflow"
                                end
                                ::_inline_end300::
                                _ret146, _ret147 = _ret149
                                goto _inline_end298
                            else
                                _ret146, _ret147 = right, "Cannot do comparison or arithmetic with " .. tostring (tx) .. " value."
                                goto _inline_end298
                            end
                        end
                        _ret146, _ret147 = right
                        goto _inline_end298
                    end
                    ::_inline_end298::
                    right, rerr = _ret146, _ret147
                    local _ret150, _ret151
                    do
                        local _ret152
                        _ret152 = type (left) == "table" and (left == empty or left.type) or type (left)
                        local tx = _ret152
                        if tx == "string" then
                            left = tonumber (left)
                            if not left then
                                _ret150, _ret151 = left, "Cannot convert the string value to a number."
                                goto _inline_end303
                            end
                        elseif tx ~= "number" then
                            if tx == "table" and left.meta.table.tonumber then
                                local meta = left.meta.table.tonumber
                                local params = {}
                                local _ret153
                                table.insert (chunk.callstack, {chunk = chunk, macro = meta, ip = ip})
                                if #chunk.callstack <= 1000 then
                                    local success, callResult, cip, source = plume.run (meta, params)
                                    if success then
                                        table.remove (chunk.callstack)
                                        _ret153 = callResult
                                        goto _inline_end305
                                    else
                                        vmserr = {callResult, cip, (source or meta)}
                                    end
                                else
                                    vmerr = "stack overflow"
                                end
                                ::_inline_end305::
                                _ret150, _ret151 = _ret153
                                goto _inline_end303
                            else
                                _ret150, _ret151 = left, "Cannot do comparison or arithmetic with " .. tostring (tx) .. " value."
                                goto _inline_end303
                            end
                        end
                        _ret150, _ret151 = left
                        goto _inline_end303
                    end
                    ::_inline_end303::
                    left, lerr = _ret150, _ret151
                    if lerr or rerr then
                        local _ret154, _ret155
                        do
                            local meta, params
                            local _ret156
                            _ret156 = type (left) == "table" and (left == empty or left.type) or type (left)
                            local tleft = _ret156
                            local _ret157
                            _ret157 = type (right) == "table" and (right == empty or right.type) or type (right)
                            local tright = _ret157
                            if tleft == "table" and left.meta and left.meta.table["div" .. "r"] then
                                meta = left.meta.table["div" .. "r"]
                                params = {right, left}
                            elseif tright == "table" and right.meta and right.meta.table["div" .. "l"] then
                                meta = right.meta.table["div" .. "l"]
                                params = {left, right}
                            elseif tleft == "table" and left.meta and left.meta.table.div then
                                meta = left.meta.table.div
                                params = {left, right, left}
                            elseif tright == "table" and right.meta and right.meta.table.div then
                                meta = right.meta.table.div
                                params = {left, right, right}
                            end
                            if not meta then
                                _ret154 = false
                                goto _inline_end308
                            end
                            local _ret158
                            table.insert (chunk.callstack, {chunk = chunk, macro = meta, ip = ip})
                            if #chunk.callstack <= 1000 then
                                local success, callResult, cip, source = plume.run (meta, params)
                                if success then
                                    table.remove (chunk.callstack)
                                    _ret158 = callResult
                                    goto _inline_end311
                                else
                                    vmserr = {callResult, cip, (source or meta)}
                                end
                            else
                                vmerr = "stack overflow"
                            end
                            ::_inline_end311::
                            _ret154, _ret155 = true, _ret158
                            goto _inline_end308
                        end
                        ::_inline_end308::
                        success, result = _ret154, _ret155
                    else
                        success = true
                        local _ret159
                        _ret159 = left / right
                        goto _inline_end314
                        ::_inline_end314::
                        result = _ret159
                    end
                    if success then
                        mainStackPointer = mainStackPointer + 1
                        mainStack[mainStackPointer] = result
                    else
                        vmerr = lerr or rerr
                    end
                end
                goto DISPATCH
            ::OPP_NEG::
                do
                    local _ret160
                    mainStackPointer = mainStackPointer - 1
                    _ret160 = mainStack[mainStackPointer + 1]
                    local x = _ret160
                    local err
                    local _ret161, _ret162
                    do
                        local _ret163
                        _ret163 = type (x) == "table" and (x == empty or x.type) or type (x)
                        local tx = _ret163
                        if tx == "string" then
                            x = tonumber (x)
                            if not x then
                                _ret161, _ret162 = x, "Cannot convert the string value to a number."
                                goto _inline_end320
                            end
                        elseif tx ~= "number" then
                            if tx == "table" and x.meta.table.tonumber then
                                local meta = x.meta.table.tonumber
                                local params = {}
                                local _ret164
                                table.insert (chunk.callstack, {chunk = chunk, macro = meta, ip = ip})
                                if #chunk.callstack <= 1000 then
                                    local success, callResult, cip, source = plume.run (meta, params)
                                    if success then
                                        table.remove (chunk.callstack)
                                        _ret164 = callResult
                                        goto _inline_end322
                                    else
                                        vmserr = {callResult, cip, (source or meta)}
                                    end
                                else
                                    vmerr = "stack overflow"
                                end
                                ::_inline_end322::
                                _ret161, _ret162 = _ret164
                                goto _inline_end320
                            else
                                _ret161, _ret162 = x, "Cannot do comparison or arithmetic with " .. tostring (tx) .. " value."
                                goto _inline_end320
                            end
                        end
                        _ret161, _ret162 = x
                        goto _inline_end320
                    end
                    ::_inline_end320::
                    x, err = _ret161, _ret162
                    if err then
                        local _ret165, _ret166
                        do
                            local meta
                            local params = {x}
                            local _ret167
                            _ret167 = type (x) == "table" and (x == empty or x.type) or type (x)
                            if _ret167 == "table" and x.meta and x.meta.table.minus then
                                meta = x.meta.table.minus
                            end
                            if not meta then
                                _ret165 = false
                                goto _inline_end325
                            end
                            local _ret168
                            table.insert (chunk.callstack, {chunk = chunk, macro = meta, ip = ip})
                            if #chunk.callstack <= 1000 then
                                local success, callResult, cip, source = plume.run (meta, params)
                                if success then
                                    table.remove (chunk.callstack)
                                    _ret168 = callResult
                                    goto _inline_end327
                                else
                                    vmserr = {callResult, cip, (source or meta)}
                                end
                            else
                                vmerr = "stack overflow"
                            end
                            ::_inline_end327::
                            _ret165, _ret166 = true, _ret168
                            goto _inline_end325
                        end
                        ::_inline_end325::
                        success, result = _ret165, _ret166
                    else
                        success = true
                        local _ret169
                        _ret169 = -x
                        goto _inline_end330
                        ::_inline_end330::
                        result = _ret169
                    end
                    if success then
                        mainStackPointer = mainStackPointer + 1
                        mainStack[mainStackPointer] = result
                    else
                        vmerr = err
                    end
                end
                goto DISPATCH
            ::OPP_MOD::
                do
                    local _ret170
                    mainStackPointer = mainStackPointer - 1
                    _ret170 = mainStack[mainStackPointer + 1]
                    local right = _ret170
                    local _ret171
                    mainStackPointer = mainStackPointer - 1
                    _ret171 = mainStack[mainStackPointer + 1]
                    local left = _ret171
                    local rerr, lerr, success, result
                    local _ret172, _ret173
                    do
                        local _ret174
                        _ret174 = type (right) == "table" and (right == empty or right.type) or type (right)
                        local tx = _ret174
                        if tx == "string" then
                            right = tonumber (right)
                            if not right then
                                _ret172, _ret173 = right, "Cannot convert the string value to a number."
                                goto _inline_end337
                            end
                        elseif tx ~= "number" then
                            if tx == "table" and right.meta.table.tonumber then
                                local meta = right.meta.table.tonumber
                                local params = {}
                                local _ret175
                                table.insert (chunk.callstack, {chunk = chunk, macro = meta, ip = ip})
                                if #chunk.callstack <= 1000 then
                                    local success, callResult, cip, source = plume.run (meta, params)
                                    if success then
                                        table.remove (chunk.callstack)
                                        _ret175 = callResult
                                        goto _inline_end339
                                    else
                                        vmserr = {callResult, cip, (source or meta)}
                                    end
                                else
                                    vmerr = "stack overflow"
                                end
                                ::_inline_end339::
                                _ret172, _ret173 = _ret175
                                goto _inline_end337
                            else
                                _ret172, _ret173 = right, "Cannot do comparison or arithmetic with " .. tostring (tx) .. " value."
                                goto _inline_end337
                            end
                        end
                        _ret172, _ret173 = right
                        goto _inline_end337
                    end
                    ::_inline_end337::
                    right, rerr = _ret172, _ret173
                    local _ret176, _ret177
                    do
                        local _ret178
                        _ret178 = type (left) == "table" and (left == empty or left.type) or type (left)
                        local tx = _ret178
                        if tx == "string" then
                            left = tonumber (left)
                            if not left then
                                _ret176, _ret177 = left, "Cannot convert the string value to a number."
                                goto _inline_end342
                            end
                        elseif tx ~= "number" then
                            if tx == "table" and left.meta.table.tonumber then
                                local meta = left.meta.table.tonumber
                                local params = {}
                                local _ret179
                                table.insert (chunk.callstack, {chunk = chunk, macro = meta, ip = ip})
                                if #chunk.callstack <= 1000 then
                                    local success, callResult, cip, source = plume.run (meta, params)
                                    if success then
                                        table.remove (chunk.callstack)
                                        _ret179 = callResult
                                        goto _inline_end344
                                    else
                                        vmserr = {callResult, cip, (source or meta)}
                                    end
                                else
                                    vmerr = "stack overflow"
                                end
                                ::_inline_end344::
                                _ret176, _ret177 = _ret179
                                goto _inline_end342
                            else
                                _ret176, _ret177 = left, "Cannot do comparison or arithmetic with " .. tostring (tx) .. " value."
                                goto _inline_end342
                            end
                        end
                        _ret176, _ret177 = left
                        goto _inline_end342
                    end
                    ::_inline_end342::
                    left, lerr = _ret176, _ret177
                    if lerr or rerr then
                        local _ret180, _ret181
                        do
                            local meta, params
                            local _ret182
                            _ret182 = type (left) == "table" and (left == empty or left.type) or type (left)
                            local tleft = _ret182
                            local _ret183
                            _ret183 = type (right) == "table" and (right == empty or right.type) or type (right)
                            local tright = _ret183
                            if tleft == "table" and left.meta and left.meta.table["mod" .. "r"] then
                                meta = left.meta.table["mod" .. "r"]
                                params = {right, left}
                            elseif tright == "table" and right.meta and right.meta.table["mod" .. "l"] then
                                meta = right.meta.table["mod" .. "l"]
                                params = {left, right}
                            elseif tleft == "table" and left.meta and left.meta.table.mod then
                                meta = left.meta.table.mod
                                params = {left, right, left}
                            elseif tright == "table" and right.meta and right.meta.table.mod then
                                meta = right.meta.table.mod
                                params = {left, right, right}
                            end
                            if not meta then
                                _ret180 = false
                                goto _inline_end347
                            end
                            local _ret184
                            table.insert (chunk.callstack, {chunk = chunk, macro = meta, ip = ip})
                            if #chunk.callstack <= 1000 then
                                local success, callResult, cip, source = plume.run (meta, params)
                                if success then
                                    table.remove (chunk.callstack)
                                    _ret184 = callResult
                                    goto _inline_end350
                                else
                                    vmserr = {callResult, cip, (source or meta)}
                                end
                            else
                                vmerr = "stack overflow"
                            end
                            ::_inline_end350::
                            _ret180, _ret181 = true, _ret184
                            goto _inline_end347
                        end
                        ::_inline_end347::
                        success, result = _ret180, _ret181
                    else
                        success = true
                        local _ret185
                        _ret185 = left % right
                        goto _inline_end353
                        ::_inline_end353::
                        result = _ret185
                    end
                    if success then
                        mainStackPointer = mainStackPointer + 1
                        mainStack[mainStackPointer] = result
                    else
                        vmerr = lerr or rerr
                    end
                end
                goto DISPATCH
            ::OPP_POW::
                do
                    local _ret186
                    mainStackPointer = mainStackPointer - 1
                    _ret186 = mainStack[mainStackPointer + 1]
                    local right = _ret186
                    local _ret187
                    mainStackPointer = mainStackPointer - 1
                    _ret187 = mainStack[mainStackPointer + 1]
                    local left = _ret187
                    local rerr, lerr, success, result
                    local _ret188, _ret189
                    do
                        local _ret190
                        _ret190 = type (right) == "table" and (right == empty or right.type) or type (right)
                        local tx = _ret190
                        if tx == "string" then
                            right = tonumber (right)
                            if not right then
                                _ret188, _ret189 = right, "Cannot convert the string value to a number."
                                goto _inline_end360
                            end
                        elseif tx ~= "number" then
                            if tx == "table" and right.meta.table.tonumber then
                                local meta = right.meta.table.tonumber
                                local params = {}
                                local _ret191
                                table.insert (chunk.callstack, {chunk = chunk, macro = meta, ip = ip})
                                if #chunk.callstack <= 1000 then
                                    local success, callResult, cip, source = plume.run (meta, params)
                                    if success then
                                        table.remove (chunk.callstack)
                                        _ret191 = callResult
                                        goto _inline_end362
                                    else
                                        vmserr = {callResult, cip, (source or meta)}
                                    end
                                else
                                    vmerr = "stack overflow"
                                end
                                ::_inline_end362::
                                _ret188, _ret189 = _ret191
                                goto _inline_end360
                            else
                                _ret188, _ret189 = right, "Cannot do comparison or arithmetic with " .. tostring (tx) .. " value."
                                goto _inline_end360
                            end
                        end
                        _ret188, _ret189 = right
                        goto _inline_end360
                    end
                    ::_inline_end360::
                    right, rerr = _ret188, _ret189
                    local _ret192, _ret193
                    do
                        local _ret194
                        _ret194 = type (left) == "table" and (left == empty or left.type) or type (left)
                        local tx = _ret194
                        if tx == "string" then
                            left = tonumber (left)
                            if not left then
                                _ret192, _ret193 = left, "Cannot convert the string value to a number."
                                goto _inline_end365
                            end
                        elseif tx ~= "number" then
                            if tx == "table" and left.meta.table.tonumber then
                                local meta = left.meta.table.tonumber
                                local params = {}
                                local _ret195
                                table.insert (chunk.callstack, {chunk = chunk, macro = meta, ip = ip})
                                if #chunk.callstack <= 1000 then
                                    local success, callResult, cip, source = plume.run (meta, params)
                                    if success then
                                        table.remove (chunk.callstack)
                                        _ret195 = callResult
                                        goto _inline_end367
                                    else
                                        vmserr = {callResult, cip, (source or meta)}
                                    end
                                else
                                    vmerr = "stack overflow"
                                end
                                ::_inline_end367::
                                _ret192, _ret193 = _ret195
                                goto _inline_end365
                            else
                                _ret192, _ret193 = left, "Cannot do comparison or arithmetic with " .. tostring (tx) .. " value."
                                goto _inline_end365
                            end
                        end
                        _ret192, _ret193 = left
                        goto _inline_end365
                    end
                    ::_inline_end365::
                    left, lerr = _ret192, _ret193
                    if lerr or rerr then
                        local _ret196, _ret197
                        do
                            local meta, params
                            local _ret198
                            _ret198 = type (left) == "table" and (left == empty or left.type) or type (left)
                            local tleft = _ret198
                            local _ret199
                            _ret199 = type (right) == "table" and (right == empty or right.type) or type (right)
                            local tright = _ret199
                            if tleft == "table" and left.meta and left.meta.table["pow" .. "r"] then
                                meta = left.meta.table["pow" .. "r"]
                                params = {right, left}
                            elseif tright == "table" and right.meta and right.meta.table["pow" .. "l"] then
                                meta = right.meta.table["pow" .. "l"]
                                params = {left, right}
                            elseif tleft == "table" and left.meta and left.meta.table.pow then
                                meta = left.meta.table.pow
                                params = {left, right, left}
                            elseif tright == "table" and right.meta and right.meta.table.pow then
                                meta = right.meta.table.pow
                                params = {left, right, right}
                            end
                            if not meta then
                                _ret196 = false
                                goto _inline_end370
                            end
                            local _ret200
                            table.insert (chunk.callstack, {chunk = chunk, macro = meta, ip = ip})
                            if #chunk.callstack <= 1000 then
                                local success, callResult, cip, source = plume.run (meta, params)
                                if success then
                                    table.remove (chunk.callstack)
                                    _ret200 = callResult
                                    goto _inline_end373
                                else
                                    vmserr = {callResult, cip, (source or meta)}
                                end
                            else
                                vmerr = "stack overflow"
                            end
                            ::_inline_end373::
                            _ret196, _ret197 = true, _ret200
                            goto _inline_end370
                        end
                        ::_inline_end370::
                        success, result = _ret196, _ret197
                    else
                        success = true
                        local _ret201
                        _ret201 = left ^ right
                        goto _inline_end376
                        ::_inline_end376::
                        result = _ret201
                    end
                    if success then
                        mainStackPointer = mainStackPointer + 1
                        mainStack[mainStackPointer] = result
                    else
                        vmerr = lerr or rerr
                    end
                end
                goto DISPATCH
            ::OPP_LT::
                do
                    local _ret202
                    mainStackPointer = mainStackPointer - 1
                    _ret202 = mainStack[mainStackPointer + 1]
                    local right = _ret202
                    local _ret203
                    mainStackPointer = mainStackPointer - 1
                    _ret203 = mainStack[mainStackPointer + 1]
                    local left = _ret203
                    local rerr, lerr, success, result
                    local _ret204, _ret205
                    do
                        local _ret206
                        _ret206 = type (right) == "table" and (right == empty or right.type) or type (right)
                        local tx = _ret206
                        if tx == "string" then
                            right = tonumber (right)
                            if not right then
                                _ret204, _ret205 = right, "Cannot convert the string value to a number."
                                goto _inline_end383
                            end
                        elseif tx ~= "number" then
                            if tx == "table" and right.meta.table.tonumber then
                                local meta = right.meta.table.tonumber
                                local params = {}
                                local _ret207
                                table.insert (chunk.callstack, {chunk = chunk, macro = meta, ip = ip})
                                if #chunk.callstack <= 1000 then
                                    local success, callResult, cip, source = plume.run (meta, params)
                                    if success then
                                        table.remove (chunk.callstack)
                                        _ret207 = callResult
                                        goto _inline_end385
                                    else
                                        vmserr = {callResult, cip, (source or meta)}
                                    end
                                else
                                    vmerr = "stack overflow"
                                end
                                ::_inline_end385::
                                _ret204, _ret205 = _ret207
                                goto _inline_end383
                            else
                                _ret204, _ret205 = right, "Cannot do comparison or arithmetic with " .. tostring (tx) .. " value."
                                goto _inline_end383
                            end
                        end
                        _ret204, _ret205 = right
                        goto _inline_end383
                    end
                    ::_inline_end383::
                    right, rerr = _ret204, _ret205
                    local _ret208, _ret209
                    do
                        local _ret210
                        _ret210 = type (left) == "table" and (left == empty or left.type) or type (left)
                        local tx = _ret210
                        if tx == "string" then
                            left = tonumber (left)
                            if not left then
                                _ret208, _ret209 = left, "Cannot convert the string value to a number."
                                goto _inline_end388
                            end
                        elseif tx ~= "number" then
                            if tx == "table" and left.meta.table.tonumber then
                                local meta = left.meta.table.tonumber
                                local params = {}
                                local _ret211
                                table.insert (chunk.callstack, {chunk = chunk, macro = meta, ip = ip})
                                if #chunk.callstack <= 1000 then
                                    local success, callResult, cip, source = plume.run (meta, params)
                                    if success then
                                        table.remove (chunk.callstack)
                                        _ret211 = callResult
                                        goto _inline_end390
                                    else
                                        vmserr = {callResult, cip, (source or meta)}
                                    end
                                else
                                    vmerr = "stack overflow"
                                end
                                ::_inline_end390::
                                _ret208, _ret209 = _ret211
                                goto _inline_end388
                            else
                                _ret208, _ret209 = left, "Cannot do comparison or arithmetic with " .. tostring (tx) .. " value."
                                goto _inline_end388
                            end
                        end
                        _ret208, _ret209 = left
                        goto _inline_end388
                    end
                    ::_inline_end388::
                    left, lerr = _ret208, _ret209
                    if lerr or rerr then
                        local _ret212, _ret213
                        do
                            local meta, params
                            local _ret214
                            _ret214 = type (left) == "table" and (left == empty or left.type) or type (left)
                            local tleft = _ret214
                            local _ret215
                            _ret215 = type (right) == "table" and (right == empty or right.type) or type (right)
                            local tright = _ret215
                            if tleft == "table" and left.meta and left.meta.table["lt" .. "r"] then
                                meta = left.meta.table["lt" .. "r"]
                                params = {right, left}
                            elseif tright == "table" and right.meta and right.meta.table["lt" .. "l"] then
                                meta = right.meta.table["lt" .. "l"]
                                params = {left, right}
                            elseif tleft == "table" and left.meta and left.meta.table.lt then
                                meta = left.meta.table.lt
                                params = {left, right, left}
                            elseif tright == "table" and right.meta and right.meta.table.lt then
                                meta = right.meta.table.lt
                                params = {left, right, right}
                            end
                            if not meta then
                                _ret212 = false
                                goto _inline_end393
                            end
                            local _ret216
                            table.insert (chunk.callstack, {chunk = chunk, macro = meta, ip = ip})
                            if #chunk.callstack <= 1000 then
                                local success, callResult, cip, source = plume.run (meta, params)
                                if success then
                                    table.remove (chunk.callstack)
                                    _ret216 = callResult
                                    goto _inline_end396
                                else
                                    vmserr = {callResult, cip, (source or meta)}
                                end
                            else
                                vmerr = "stack overflow"
                            end
                            ::_inline_end396::
                            _ret212, _ret213 = true, _ret216
                            goto _inline_end393
                        end
                        ::_inline_end393::
                        success, result = _ret212, _ret213
                    else
                        success = true
                        local _ret217
                        _ret217 = left < right
                        goto _inline_end399
                        ::_inline_end399::
                        result = _ret217
                    end
                    if success then
                        mainStackPointer = mainStackPointer + 1
                        mainStack[mainStackPointer] = result
                    else
                        vmerr = lerr or rerr
                    end
                end
                goto DISPATCH
            ::OPP_EQ::
                do
                    local _ret218
                    mainStackPointer = mainStackPointer - 1
                    _ret218 = mainStack[mainStackPointer + 1]
                    local right = _ret218
                    local _ret219
                    mainStackPointer = mainStackPointer - 1
                    _ret219 = mainStack[mainStackPointer + 1]
                    local left = _ret219
                    local _ret220, _ret221
                    do
                        local meta, params
                        local _ret222
                        _ret222 = type (left) == "table" and (left == empty or left.type) or type (left)
                        local tleft = _ret222
                        local _ret223
                        _ret223 = type (right) == "table" and (right == empty or right.type) or type (right)
                        local tright = _ret223
                        if tleft == "table" and left.meta and left.meta.table["eq" .. "r"] then
                            meta = left.meta.table["eq" .. "r"]
                            params = {right, left}
                        elseif tright == "table" and right.meta and right.meta.table["eq" .. "l"] then
                            meta = right.meta.table["eq" .. "l"]
                            params = {left, right}
                        elseif tleft == "table" and left.meta and left.meta.table.eq then
                            meta = left.meta.table.eq
                            params = {left, right, left}
                        elseif tright == "table" and right.meta and right.meta.table.eq then
                            meta = right.meta.table.eq
                            params = {left, right, right}
                        end
                        if not meta then
                            _ret220 = false
                            goto _inline_end405
                        end
                        local _ret224
                        table.insert (chunk.callstack, {chunk = chunk, macro = meta, ip = ip})
                        if #chunk.callstack <= 1000 then
                            local success, callResult, cip, source = plume.run (meta, params)
                            if success then
                                table.remove (chunk.callstack)
                                _ret224 = callResult
                                goto _inline_end408
                            else
                                vmserr = {callResult, cip, (source or meta)}
                            end
                        else
                            vmerr = "stack overflow"
                        end
                        ::_inline_end408::
                        _ret220, _ret221 = true, _ret224
                        goto _inline_end405
                    end
                    ::_inline_end405::
                    local success, result = _ret220, _ret221
                    if not success then
                        result = left == right or tonumber (left) and tonumber (left) == tonumber (right)
                    end
                    mainStackPointer = mainStackPointer + 1
                    mainStack[mainStackPointer] = result
                end
                goto DISPATCH
            ::OPP_AND::
                do
                    local _ret225
                    mainStackPointer = mainStackPointer - 1
                    _ret225 = mainStack[mainStackPointer + 1]
                    local right = _ret225
                    local _ret226
                    mainStackPointer = mainStackPointer - 1
                    _ret226 = mainStack[mainStackPointer + 1]
                    local left = _ret226
                    local _ret227
                    if right == empty then
                        _ret227 = false
                        goto _inline_end416
                    end
                    _ret227 = right
                    ::_inline_end416::
                    right = _ret227
                    local _ret228
                    if left == empty then
                        _ret228 = false
                        goto _inline_end417
                    end
                    _ret228 = left
                    ::_inline_end417::
                    left = _ret228
                    local _ret229
                    _ret229 = right and left
                    mainStackPointer = mainStackPointer + 1
                    mainStack[mainStackPointer] = _ret229
                end
                goto DISPATCH
            ::OPP_NOT::
                do
                    local _ret230
                    mainStackPointer = mainStackPointer - 1
                    _ret230 = mainStack[mainStackPointer + 1]
                    local x = _ret230
                    local _ret231
                    if x == empty then
                        _ret231 = false
                        goto _inline_end423
                    end
                    _ret231 = x
                    ::_inline_end423::
                    x = _ret231
                    local _ret232
                    _ret232 = not x
                    mainStackPointer = mainStackPointer + 1
                    mainStack[mainStackPointer] = _ret232
                end
                goto DISPATCH
            ::OPP_OR::
                do
                    local _ret233
                    mainStackPointer = mainStackPointer - 1
                    _ret233 = mainStack[mainStackPointer + 1]
                    local right = _ret233
                    local _ret234
                    mainStackPointer = mainStackPointer - 1
                    _ret234 = mainStack[mainStackPointer + 1]
                    local left = _ret234
                    local _ret235
                    if right == empty then
                        _ret235 = false
                        goto _inline_end430
                    end
                    _ret235 = right
                    ::_inline_end430::
                    right = _ret235
                    local _ret236
                    if left == empty then
                        _ret236 = false
                        goto _inline_end431
                    end
                    _ret236 = left
                    ::_inline_end431::
                    left = _ret236
                    local _ret237
                    _ret237 = right or left
                    mainStackPointer = mainStackPointer + 1
                    mainStack[mainStackPointer] = _ret237
                end
                goto DISPATCH
            ::DUPLICATE::
                do
                    local _ret238
                    _ret238 = mainStack[mainStackPointer]
                    mainStackPointer = mainStackPointer + 1
                    mainStack[mainStackPointer] = _ret238
                end
                goto DISPATCH
            ::SWITCH::
                do
                    local _ret239
                    mainStackPointer = mainStackPointer - 1
                    _ret239 = mainStack[mainStackPointer + 1]
                    local x = _ret239
                    local _ret240
                    mainStackPointer = mainStackPointer - 1
                    _ret240 = mainStack[mainStackPointer + 1]
                    local y = _ret240
                    mainStackPointer = mainStackPointer + 1
                    mainStack[mainStackPointer] = x
                    mainStackPointer = mainStackPointer + 1
                    mainStack[mainStackPointer] = y
                end
                goto DISPATCH
            ::END::
            local _ret241
            _ret241 = mainStack[mainStackPointer]
            return true, _ret241
        end
    end
    