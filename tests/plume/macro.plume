/// Test simple macro & call
macro quill()
  mark
end
$quill()
/// Output
mark
/// End

/// Test macro & call (1 param)
macro double(write)
  $write $write
end
$double(quill)
/// Output
quill quill
/// End

/// Test macro & call (2 params)
macro f(write, paint)
  $write $paint
end
$f(quill, mark)
/// Output
quill mark
/// End

/// Test macro & call (named params)
macro f(optn: value)
  $optn
end
$f()\n
$f(optn: another value)
/// Output
value
another value
/// End

/// Test macro & call (miwriteed params)
macro f(write, paint, optn: value)
  $write $paint $optn
end
$f(quill, mark)\n
$f(quill, ink, optn: another value)
/// Output
quill mark value
quill ink another value
/// End

/// Test macro scope
let _write = 5
macro f()
  let _write = 3
  $_write
end
$f()\n
$_write
/// Output
3
5
/// End

/// Test macro nested
macro double(write)
  $write $write
end

$double($double(quill))
/// Output
quill quill quill quill
/// End

/// Test long argument
macro id(write)
  $write
end

$id(This is quite long\, i think.)
/// Output
This is quite long, i think.
/// End

/// Test Variadic 1
set write = macro (...args)
  Positionnals args: $join(...args, sep:\,\s)\n
  Named args:\s
  @join(sep:\,\s)
    for key, value in items(args)
      - $key\=$value
    end
  end
end
$write(write, paint, song, ink: quill, wing: mark)
/// Output
Positionnals args: write, paint, song
Named args: ink=quill, wing=mark
/// End

/// Test Flag
set write = macro (?flag)
  if flag
    paint
  else
    sing
  end
end
$write()\n
$write(?flag)
/// Output
sing
paint
/// End

/// Test Leave macro (text)
let t = @table
  - blue
  - red
  - green
end

macro index(t, y)
  for i in seq(1, len(t))
    if t[i] == y
      $i
      leave
    end
  end
end

$index($t, red)
/// Output
2
/// End

/// Test Leave macro (table)
macro t()
  content: wing
  leave
  content: nib
end

$t().content
/// Output
wing
/// End

/// Test Leave file
Nib
leave
Wing
/// Output
Nib
/// End