/// Test simple While
let i = 0
while i<4
  set i = $(i+1)
  Iterate $i times...\n
end
/// Output
Iterate 1 times...
Iterate 2 times...
Iterate 3 times...
Iterate 4 times...
/// End

/// Test for over table
let t = $table(nib, quill, wing)

for write in t
  $write;
end
/// Output
nib;quill;wing;
/// End

/// Test for over table (idiomatic)
let t = $table(nib, quill, wing)

@join(sep:\n)
  for write in t
    - A new item: "$write"
  end
end
/// Output
A new item: "nib"
A new item: "quill"
A new item: "wing"
/// End

/// Test break for
for i in seq(1, 10)
  $i\n
  break
end
/// Output
1
/// End

/// Test break while
let i = 0
while i<100
  set i += 1
  if i==10
    break
  end
end
$i
/// Output
10
/// End

/// Test continue for
for i in seq(1, 3)
  if i==2
    continue
  end
  $i
end
/// Output
13
/// End

/// Test break while
let i = 0
while i<3
  set i += 1
  if i==2
    continue
  end
  $i
end
/// Output
13
/// End

/// Test break outside loop
break
/// Error
Compilation error: Cannot use break keyword outside a loop.
File 'break outside loop', line 1: break
                                   ^^^^^
/// End

/// Test break cutted from loops by macro
for i in seq(1, 10)
  let m = macro()
    break
  end
end
/// Error
Compilation error: Cannot use break keyword outside a loop.
File 'break cutted from loops by macro', line 3: break
                                                 ^^^^^
/// End

/// Test continue outside loop
continue
/// Error
Compilation error: Cannot use break keyword outside a loop.
File 'continue outside loop', line 1: continue
                                      ^^^^^^^^
/// End


/// Test continue cutted from loops by macro
for i in seq(1, 10)
  let m = macro()
    continue
  end
end
/// Error
Compilation error: Cannot use break keyword outside a loop.
File 'continue cutted from loops by macro', line 3: continue
                                                    ^^^^^^^^
/// End

/// Test iterator
set seq = macro(a, b)
  state: $a
  stop: $b
  meta next: macro()
    if self.state <= self.stop
      $self.state
      set self.state += 1
    end
  end
end

for i in seq(1, 5)
  $i
end
/// Output
12345
/// End
